<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yanlong Zhao" />


<title>Mannual for SA24204174</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Mannual for SA24204174</h1>
<h4 class="author">Yanlong Zhao</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Welcome to SA24204174! This is a package for a working paper. Since
the paper has not been made public yet, I can only show the usage
roughly and cannot tell you the exact method through formulas.</p>
</div>
<div id="implementation" class="section level2">
<h2>Implementation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(SA24204174)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;SA24204174&#39;</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:grDevices&#39;:</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt;     cm</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; Loading required package: Matrix</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;Matrix&#39; was built under R version 4.3.3</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; Loaded glmnet 4.1-7</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="fu">library</span>(caret)<span class="co">#做交叉验证用</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; Loading required package: lattice</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;foreach&quot;</span>)</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;doParallel&quot;</span>)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt; Loading required package: iterators</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="fu">library</span>(matrixcalc)</span></code></pre></div>
</div>
<div id="data-generation-process" class="section level2">
<h2>Data generation process</h2>
<p>This is the same as TransLASSO which can be found in Lisai’s
paper.</p>
<p>Consider <span class="math inline">\(p = 500, N_0 = 150\)</span>, and
<span class="math inline">\(N_1, \cdots, N_K = 100, K = 20\)</span>.
<span class="math inline">\(x_i^{(k)}, k = 1, \cdots, K\)</span> are
independent and identically distributed, following a multivariate
Gaussian distribution with mean 0 and covariance matrix equal to the
identity matrix. <span class="math inline">\(\epsilon_i^{(k)}, k = 1,
\cdots, K\)</span> are independent and identically distributed,
following a Gaussian distribution with mean 0 and variance 1. For the
target regression parameters <span class="math inline">\(\beta\)</span>,
we set <span class="math inline">\(s = 16\)</span>, <span class="math inline">\(\beta_j = 0.3, j \in \{1, \cdots, s\}\)</span>,
and <span class="math inline">\(\beta_j = 0, j \notin \{1, \cdots,
s\}\)</span>. We denote <span class="math inline">\(\mathcal{A}\)</span>
as the index set of the informative samples from the given source
domain.</p>
<ol style="list-style-type: decimal">
<li>Given the index set <span class="math inline">\(\mathcal{A}\)</span>
of informative samples from the source domain, for any <span class="math inline">\(k \in \mathcal{A}\)</span>, define</li>
</ol>
<p><span class="math display">\[
w_j^{(k)} = \beta_j - 0.3 {I} (j \in H_k),
\]</span></p>
<p>where <span class="math inline">\(H_k\)</span> is a random subset of
<span class="math inline">\([p]\)</span> with size <span class="math inline">\(|H_k| = h \in \{6\}\)</span>. For <span class="math inline">\(k \notin \mathcal{A}\)</span>, we set <span class="math inline">\(H_k\)</span> as a random subset of <span class="math inline">\([p]\)</span> with size <span class="math inline">\(|H_k| = 2s\)</span>, and <span class="math inline">\(w_j^{(k)} = \beta_j - 0.5I(j \in H_k)\)</span>. We
set <span class="math inline">\(w_1^{(k)} = -0.3, k = 1, \cdots,
K\)</span> to simulate covariate shift.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>nums <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231027</span><span class="sc">+</span>sims)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">72</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">36</span>){</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  priors[(<span class="dv">2</span><span class="sc">*</span>i<span class="dv">-1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>i)] <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>}</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># 0.5 去掉两个，偏大了！！！！！</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>sse_fit <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>sse_target_only <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>fp_lasso <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>fn_lasso <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>mse1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>fp_oracle <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>fn_oracle <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>mse2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>fp_trans <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>fn_trans <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>mse3 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>mse4 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>mse5 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>mse6 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#mse7 &lt;- NULL</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#mse8 &lt;- NULL</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>mse_single_trans1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>mse_single_trans2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>fp_target <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>fn_target <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>fp_trans1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>fn_trans1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>fp_trans2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>fn_trans2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>p_ini <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>p_1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>p_2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>p_3 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>p_4 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>p_5 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a>p_6 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a>p_last <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a>fp_ini <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a>fp_1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a>fp_2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a>fp_3 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a>fp_4 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a>fp_5 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a>fp_6 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a>fp_last <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>fn_ini <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a>fn_1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a>fn_2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a>fn_3 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a>fn_4 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a>fn_5 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a>fn_6 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a>fn_last <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a>iter_times <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a></span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a>mymse_l2_ini <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a>mymse_l2_1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a>mymse_l2_2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a>mymse_l2_3 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a>mymse_l2_4 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a>mymse_l2_5 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a>mymse_l2_6 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a>mymse_l2_last <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-73"><a href="#cb2-73" tabindex="-1"></a>  trans_sse <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-74"><a href="#cb2-74" tabindex="-1"></a>  ps <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-75"><a href="#cb2-75" tabindex="-1"></a>  n0s <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-76"><a href="#cb2-76" tabindex="-1"></a>  sizea0s <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-77"><a href="#cb2-77" tabindex="-1"></a>  sigbetas <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-78"><a href="#cb2-78" tabindex="-1"></a>  Ms <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-79"><a href="#cb2-79" tabindex="-1"></a>  hs <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-80"><a href="#cb2-80" tabindex="-1"></a>  exacts <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-81"><a href="#cb2-81" tabindex="-1"></a>  ss <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-82"><a href="#cb2-82" tabindex="-1"></a>  </span>
<span id="cb2-83"><a href="#cb2-83" tabindex="-1"></a>  cm_oracle <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-84"><a href="#cb2-84" tabindex="-1"></a>  cm_lasso <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-85"><a href="#cb2-85" tabindex="-1"></a>  cm_trans <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-86"><a href="#cb2-86" tabindex="-1"></a>  cm_my <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-87"><a href="#cb2-87" tabindex="-1"></a>  </span>
<span id="cb2-88"><a href="#cb2-88" tabindex="-1"></a>  <span class="co"># source data size</span></span>
<span id="cb2-89"><a href="#cb2-89" tabindex="-1"></a>  size.A0 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb2-90"><a href="#cb2-90" tabindex="-1"></a>  sig.beta <span class="ot">=</span> <span class="fl">0.3</span></span>
<span id="cb2-91"><a href="#cb2-91" tabindex="-1"></a>  p <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb2-92"><a href="#cb2-92" tabindex="-1"></a>  M <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb2-93"><a href="#cb2-93" tabindex="-1"></a>  n0 <span class="ot">=</span> <span class="dv">150</span></span>
<span id="cb2-94"><a href="#cb2-94" tabindex="-1"></a>  sig.z <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-95"><a href="#cb2-95" tabindex="-1"></a>  n_s <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb2-96"><a href="#cb2-96" tabindex="-1"></a>  n.vec <span class="ot">&lt;-</span> <span class="fu">c</span>(n0, <span class="fu">rep</span>(n_s, M))</span>
<span id="cb2-97"><a href="#cb2-97" tabindex="-1"></a>Sig.X <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, p)</span>
<span id="cb2-98"><a href="#cb2-98" tabindex="-1"></a>Niter <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb2-99"><a href="#cb2-99" tabindex="-1"></a>l1<span class="ot">=</span>T</span>
<span id="cb2-100"><a href="#cb2-100" tabindex="-1"></a>A0 <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>size.A0</span>
<span id="cb2-101"><a href="#cb2-101" tabindex="-1"></a>ind<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n0</span>
<span id="cb2-102"><a href="#cb2-102" tabindex="-1"></a><span class="co">#这里h变为12了，6.6</span></span>
<span id="cb2-103"><a href="#cb2-103" tabindex="-1"></a>h<span class="ot">=</span><span class="dv">6</span></span>
<span id="cb2-104"><a href="#cb2-104" tabindex="-1"></a>exact <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb2-105"><a href="#cb2-105" tabindex="-1"></a>s<span class="ot">=</span><span class="dv">16</span></span>
<span id="cb2-106"><a href="#cb2-106" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231027</span><span class="sc">+</span> sims <span class="sc">+</span> nums)</span>
<span id="cb2-107"><a href="#cb2-107" tabindex="-1"></a>                  <span class="co">#source(&quot;TransLasso-functions.R&quot;)</span></span>
<span id="cb2-108"><a href="#cb2-108" tabindex="-1"></a>                  start <span class="ot">&lt;-</span> (<span class="fu">proc.time</span>())[<span class="dv">3</span>][[<span class="dv">1</span>]]</span>
<span id="cb2-109"><a href="#cb2-109" tabindex="-1"></a>                  <span class="co">#if(size.A0&lt;1){next}</span></span>
<span id="cb2-110"><a href="#cb2-110" tabindex="-1"></a>                  nums<span class="ot">&lt;-</span>nums<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb2-111"><a href="#cb2-111" tabindex="-1"></a>                  </span>
<span id="cb2-112"><a href="#cb2-112" tabindex="-1"></a>                  <span class="co">#if(nums !=11) next</span></span>
<span id="cb2-113"><a href="#cb2-113" tabindex="-1"></a>                  <span class="fu">print</span>(nums)</span>
<span id="cb2-114"><a href="#cb2-114" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb2-115"><a href="#cb2-115" tabindex="-1"></a>                  beta0<span class="ot">&lt;-</span></span>
<span id="cb2-116"><a href="#cb2-116" tabindex="-1"></a>                  coef.all <span class="ot">&lt;-</span><span class="fu">Coef.gen</span>( s, <span class="at">h =</span> h, <span class="at">q =</span> <span class="dv">2</span><span class="sc">*</span>s, <span class="at">size.A0 =</span> size.A0,  <span class="at">M =</span> M,   <span class="at">sig.beta =</span> sig.beta,</span>
<span id="cb2-117"><a href="#cb2-117" tabindex="-1"></a>                                         <span class="at">sig.delta1 =</span> sig.beta, <span class="at">sig.delta2 =</span> sig.beta<span class="fl">+0.2</span>, <span class="at">p =</span> p, exact)</span>
<span id="cb2-118"><a href="#cb2-118" tabindex="-1"></a>                  B <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coef.all<span class="sc">$</span>beta0, coef.all<span class="sc">$</span>W)</span>
<span id="cb2-119"><a href="#cb2-119" tabindex="-1"></a>                  beta0 <span class="ot">&lt;-</span> coef.all<span class="sc">$</span>beta0</span>
<span id="cb2-120"><a href="#cb2-120" tabindex="-1"></a>                  </span>
<span id="cb2-121"><a href="#cb2-121" tabindex="-1"></a>                  <span class="do">###generate the data</span></span>
<span id="cb2-122"><a href="#cb2-122" tabindex="-1"></a>                  X <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-123"><a href="#cb2-123" tabindex="-1"></a>                  y <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-124"><a href="#cb2-124" tabindex="-1"></a>                  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(M <span class="sc">+</span> <span class="dv">1</span>)) {</span>
<span id="cb2-125"><a href="#cb2-125" tabindex="-1"></a>                    X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(X, <span class="fu">rmvnorm</span>(n.vec[k], <span class="fu">rep</span>(<span class="dv">0</span>, p), Sig.X))</span>
<span id="cb2-126"><a href="#cb2-126" tabindex="-1"></a>                    ind.k <span class="ot">&lt;-</span> <span class="fu">ind.set</span>(n.vec, k)</span>
<span id="cb2-127"><a href="#cb2-127" tabindex="-1"></a>                    y <span class="ot">&lt;-</span> <span class="fu">c</span>(y, X[ind.k, ] <span class="sc">%*%</span> B[, k] <span class="sc">+</span> <span class="fu">rnorm</span> (n.vec[k], <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb2-128"><a href="#cb2-128" tabindex="-1"></a>                  }</span></code></pre></div>
</div>
<div id="translasso" class="section level2">
<h2>TransLASSO</h2>
<p>Begin transfer learning with TransLASSO.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>                  <span class="do">###compute init beta ####</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                  mse.vec<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">8</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                  beta.init <span class="ot">&lt;-</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                    <span class="fu">as.numeric</span>(<span class="fu">glmnet</span>(X[<span class="dv">1</span><span class="sc">:</span>n.vec[<span class="dv">1</span>], ], y[<span class="dv">1</span><span class="sc">:</span>n.vec[<span class="dv">1</span>]], <span class="at">lambda =</span> <span class="fl">0.52</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(p) <span class="sc">/</span> n.vec[<span class="dv">1</span>]))<span class="sc">$</span>beta)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                  beta.init <span class="ot">&lt;-</span> <span class="fu">betascale</span>(beta.init,Sig.X)<span class="sc">*</span><span class="fl">1.2</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                  mse.vec[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">mse.fun</span>(<span class="fu">as.numeric</span>(beta.init),beta0,X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">$</span>est.err</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                  fp_lasso <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_lasso,<span class="fu">fp</span>(beta.init,beta0))</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                  fn_lasso <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_lasso,<span class="fu">fn</span>(beta.init,beta0))</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                  <span class="co">#return(list(X=X,y=y))</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>                  <span class="do">######Oracle Trans-Lasso#######</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>                  <span class="cf">if</span> (size.A0 <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>                    beta.kA <span class="ot">&lt;-</span> beta.init</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>                    mse.vec[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">mse.fun</span>(<span class="fu">as.numeric</span>(beta.kA),beta0,X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">$</span>est.err</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>                    <span class="co">#mse.vec[7] =  mse.vec[2]</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>                    <span class="co">#r1 &lt;- my_difftuning(X,y,n0,beta0,beta.init,0.04)$beta</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>                    <span class="co">#mse.vec[7] =  mse.fun(as.numeric(r1),y[1:n0], beta0)$est.err</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>                  } <span class="cf">else</span>{</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>                    sr <span class="ot">&lt;-</span> <span class="fu">las.kA</span>(X, y, <span class="at">A0 =</span> <span class="dv">1</span><span class="sc">:</span>size.A0, <span class="at">n.vec =</span> n.vec, <span class="at">l1=</span>l1)</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>                    beta.kA <span class="ot">&lt;-</span> sr<span class="sc">$</span>beta.kA</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>                    w.kA <span class="ot">&lt;-</span> sr<span class="sc">$</span>w.kA</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>                    <span class="co">#cat(&#39;oracle_lambda:&#39;,sr$lam.const,&#39;\n&#39;)</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>                    beta.kA <span class="ot">&lt;-</span> <span class="fu">betascale</span>(beta.kA,Sig.X)<span class="sc">*</span><span class="fl">1.2</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>                    mse.vec[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">mse.fun</span>(<span class="fu">as.numeric</span>(beta.kA),beta0,X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">$</span>est.err</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>                    <span class="co">#mse.vec[7] =  mse.fun(as.numeric(w.kA),y[1:n0], beta0)$est.err</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>                    <span class="co">#r1 &lt;- my_difftuning(X,y,n0,beta0,sr$beta.kA,sr$lam.const)$beta</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>                    <span class="co">#cat(&#39;oracle with my tuning:&#39;,r1[1:16],&#39;\n&#39;)</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>                    <span class="co">#mse.vec[7] =  mse.fun(r1,y[1:n0], beta0)$est.err</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>                  }</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>                  fp_oracle <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_oracle,<span class="fu">fp</span>(beta.kA,beta0))</span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>                  fn_oracle <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_oracle,<span class="fu">fn</span>(beta.kA,beta0))</span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>                  <span class="do">###########Trans-Lasso#############</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>                  prop.re1 <span class="ot">&lt;-</span> <span class="fu">Trans.lasso</span>(X, y, n.vec, <span class="at">I.til =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="at">l1 =</span> l1)</span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>                  prop.re2 <span class="ot">&lt;-</span> <span class="fu">Trans.lasso</span>(X, y, n.vec, <span class="at">I.til =</span> <span class="dv">51</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">l1=</span>l1)</span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>                  prop.re3 <span class="ot">&lt;-</span> <span class="fu">Trans.lasso</span>(X, y, n.vec, <span class="at">I.til =</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">150</span>, <span class="at">l1=</span>l1)</span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a>                  <span class="cf">if</span>(size.A0 <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> size.A0<span class="sc">&lt;</span> M){ <span class="co">#Rank.re characterizes the performance of the sparsity index Rk</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a>                    Rank.re<span class="ot">&lt;-</span> (<span class="fu">sum</span>(prop.re1<span class="sc">$</span>rank.pi[<span class="dv">1</span><span class="sc">:</span>size.A0]<span class="sc">&lt;=</span>size.A0) <span class="sc">+</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>                                 <span class="fu">sum</span>(prop.re2<span class="sc">$</span>rank.pi[<span class="dv">1</span><span class="sc">:</span>size.A0]<span class="sc">&lt;=</span>size.A0))<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>size.A0</span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>                  }<span class="cf">else</span>{ Rank.re <span class="ot">&lt;-</span> <span class="dv">1</span> }</span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a>                  beta.prop <span class="ot">&lt;-</span> (prop.re1<span class="sc">$</span>beta.hat  <span class="sc">+</span> prop.re3<span class="sc">$</span>beta.hat) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>                  beta.prop <span class="ot">&lt;-</span> beta.prop<span class="sc">*</span>(<span class="fu">abs</span>(beta.prop)<span class="sc">&gt;</span><span class="fl">0.002</span>)</span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a>                  prop.re1<span class="sc">$</span>beta.hat <span class="ot">&lt;-</span> prop.re1<span class="sc">$</span>beta.hat<span class="sc">*</span>(<span class="fu">abs</span>(prop.re1<span class="sc">$</span>beta.hat)<span class="sc">&gt;</span><span class="fl">0.002</span>)</span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>                  prop.re3<span class="sc">$</span>beta.hat <span class="ot">&lt;-</span> prop.re1<span class="sc">$</span>beta.hat<span class="sc">*</span>(<span class="fu">abs</span>(prop.re3<span class="sc">$</span>beta.hat)<span class="sc">&gt;</span><span class="fl">0.002</span>)</span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a>                  mse_single_trans1 <span class="ot">&lt;-</span> <span class="fu">c</span>(  mse_single_trans1,<span class="fu">mse.fun</span>(prop.re1<span class="sc">$</span>beta.hat ,beta0,X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">$</span>est.err)</span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>                  mse_single_trans2 <span class="ot">&lt;-</span> <span class="fu">c</span>(  mse_single_trans2,<span class="fu">mse.fun</span>(prop.re3<span class="sc">$</span>beta.hat ,beta0,X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">$</span>est.err)</span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;beta.kA:&#39;</span>,beta.kA,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="co">#&gt; beta.kA: 0 0.4450771 0 0.05977404 0.3362344 0.2773827 0.3915175 0 0.1202553 0.1152364 0.3961189 0 0 0.3898894 0.2320926 0.1629202 0 0 0 0 0 0 0 0 0 0 0 0 -0.02325135 0 0 0 0 0 0 0 0 0.06038035 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1480853 0 0.07195081 0 0 0 -0.0505262 0 0 0 0 0.1237265 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -0.05608764 0 0 0 0 0 0.1139019 0.04996021 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.06054413 0 -0.007711985 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09057626 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1378023 0 0.3062912 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.01113456 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -0.00825238 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.007761684 0 0.0005613712 0 0 0 0 0 0 0 -0.01797312 0 0 0.06905169 0 0 0 0 0 0 0 0 0 -0.169553 0 0 0 0 0 0.02063433 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.09421315 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2296441 0 0 0 0 0 0 0 0 0 0 -0.2210103 0 0 0 0 0 0 0 0 0 0 0.01792296 0 0 0 0 0 -0.05300882 0.3534943 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.01357252 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1002895 0 0 0 0 0 0 0 0 0 -0.03136641 0 0 0 0 0 0 0 0 0 0 0 0.02983403 0.01716509 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;beta.prop:&#39;</span>,beta.prop,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a><span class="co">#&gt; beta.prop: -0.1281977 0.2076319 0.1824459 0.2455366 0.1355962 0.2116208 0.1918151 0.134628 0.02261002 0.09803569 0.2310128 0.1778983 0.1222336 0.17104 0.1602257 0.1872819 -0.03802898 0.01328431 0 0.003472574 0 -0.06768694 0 -0.003614854 0 -0.01628026 0 0 0 0 -0.007703794 -0.04233711 0.008533108 0 0 0 0.0050944 -0.04402645 -0.03029662 0.01674341 -0.012673 0 -0.02458632 0 0 -0.002867972 0 0 -0.06139113 0.006311592 -0.03107823 -0.004098708 0 0 0 -0.04385724 0 -0.01518011 0.01227566 -0.004117666 -0.01372556 0 0 0 0.005520344 -0.04312128 0.01099464 -0.00579621 -0.007532725 0 0 0 0 0 0 0.0931822 0 -0.01439858 0 0 0 -0.03187529 0 -0.06200732 0.005237369 0 -0.1090517 -0.05960231 0.1007461 -0.1022616 -0.04075425 -0.03766641 0 0 0 0.02976894 -0.005154614 0 0 0 0 -0.03239481 0 -0.07335988 -0.03198867 -0.06185603 0.002762435 -0.003798199 0 0 0 0 -0.06139866 0 0 -0.01164589 0.003149147 0 0 0 0 0 0 -0.002800374 0 0 0 0.0558415 0.03178154 0.009368496 -0.01842657 0 0 0 0 0 -0.06041714 0 0 0 0 0 0 -0.01640226 0.003023306 -0.03218587 0 -0.002958979 0 0 0 0 0 0 0.003795583 0 0.03215326 0.01386762 0 0 0 0 -0.02318564 0 0.02602173 0 0.04545435 0.008381147 0 0.01368839 -0.01433874 0 0 0 0 0 0.03234615 0 0 0 -0.004061246 0.02752657 0 0 -0.02670222 -0.05550018 -0.09126272 -0.007921522 -0.1972133 0 0 0 0 0 0 -0.006154522 0 -0.04862294 0 -0.00529746 0 -0.04113241 -0.02391844 0 0 0.03045143 -0.006736566 0 0 0.06730059 -0.04516386 -0.004290711 0 0 0 -0.004326226 0 -0.04863843 0 0 0 -0.00700835 0 -0.04811934 0.00582343 0 0 0 0.02940839 -0.01017619 0 0 0 -0.007988794 -0.01266811 0 0 -0.01133562 0 -0.005271871 0 0.002522703 -0.01093492 -0.01217522 0 0.01823224 0 0 0 -0.003611898 -0.002445991 0 -0.009671375 0 0 -0.0416145 0 -0.1184288 0 0 0 -0.0333271 0.03946262 0.1047548 0 0 0 0.04444924 0 0 0 -0.009508723 0 0.05786714 0 -0.1003847 0.01527506 0 0 -0.1463609 -0.01373726 0 0 0 0 -0.008852538 0 0 -0.07737908 0 0.004379117 0 0 -0.01269698 0 -0.03218518 0 -0.01720253 0 -0.07155306 -0.005207815 0 0 0 -0.03670753 0 0 0.01443172 0 0 0 0 -0.02100447 0 0 0.0085768 0 0 -0.006227384 0 0 0 0.002610284 0 0 0.00955805 0 0 0.004623539 0 0 -0.03566201 0 0.006761046 0.005225768 0 0 0 0 0 0 0 0 0.003298157 0 0 0 0 0 -0.01470582 0 0 0 0 -0.0925846 0 0 -0.08980226 0 0 0 -0.08176785 0 0 0 0.01504438 0.01474658 0 -0.005919756 0 0 -0.005131946 0.03431352 0 0 0 0 -0.07898942 0 0 -0.02885814 -0.002896671 0 -0.122845 0 -0.07012017 0 -0.01509401 -0.04098658 0 0 -0.06098946 0 -0.1054392 0.04199199 0 0 -0.03618889 0.005134191 -0.01303128 0.002848794 0 0 0 0 0 0.04909752 0 0 0 0 -0.002672532 0.01304521 -0.09069931 0 -0.008220867 -0.02138143 -0.09232875 -0.002322927 0.03520448 0.08098404 0 0.04489652 0 0 -0.03085063 0 0 0.01380785 0 0.1162293 -0.007458603 0 0 0 0 0 -0.006617363 -0.0569814 0 0.02535177 0 -0.01554723 -0.006291791 -0.0668125 -0.004332174 0 0 -0.01146883 0 0.01833909 0 -0.007929811 0 -0.01211685 0 0 -0.01760229 0 0 0 -0.009145797 0 0 0 0 0 -0.004993376 -0.1170485 0 0 0 -0.09598775 0 0.02543356 0 0 0 0 0 0 0 -0.1282747 0 0 0 0 -0.07050204 0 -0.1291701 -0.005434198 -0.02045212 -0.04954609 -0.02978604 0 0 0 0 -0.0336719 0.03615846</span></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a>                  beta.prop <span class="ot">&lt;-</span> <span class="fu">betascale</span>(beta.prop,Sig.X)<span class="sc">*</span><span class="fl">1.2</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;trans:&#39;</span>,<span class="fu">mse.fun</span>(beta.prop,beta0,X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">$</span>est.err,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a><span class="co">#&gt; trans: 1.120701</span></span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a>                  trans_sse <span class="ot">&lt;-</span> <span class="fu">c</span>(trans_sse,<span class="fu">mse.fun</span>(beta.prop,beta0,X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">$</span>est.err)</span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a>                  fp_trans <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_trans,<span class="fu">fp</span>(beta.prop,beta0))</span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a>                  fn_trans <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_trans,<span class="fu">fn</span>(beta.prop,beta0))</span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a>                  fp_trans1 <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_trans1,<span class="fu">fp</span>(prop.re1<span class="sc">$</span>beta.hat,beta0))</span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a>                  fn_trans1 <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_trans1,<span class="fu">fn</span>(prop.re1<span class="sc">$</span>beta.hat,beta0))</span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a>                  fp_trans2 <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_trans2,<span class="fu">fp</span>(prop.re3<span class="sc">$</span>beta.hat,beta0))</span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a>                  fn_trans2 <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_trans2,<span class="fu">fn</span>(prop.re3<span class="sc">$</span>beta.hat,beta0))</span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>                  mse.vec[<span class="dv">3</span>] <span class="ot">=</span> <span class="fu">mse.fun</span>(beta.prop,beta0,X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">$</span>est.err</span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a>                  </span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a>                  <span class="do">######A method for comparison: it has the same pipeline of the Trans-Lasso</span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a>                  <span class="do">###but with sparsity index R_k=\|w^{(k)}-\beta\|_1 and a naive aggregation (empirical risk minimization)</span></span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a>                  prop.sp.re1 <span class="ot">&lt;-</span> <span class="fu">Trans.lasso.sp</span>(X, y, n.vec, <span class="at">I.til =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="at">l1 =</span> l1)</span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a>                  prop.sp.re2 <span class="ot">&lt;-</span> <span class="fu">Trans.lasso.sp</span>(X, y, n.vec, <span class="at">I.til =</span> <span class="dv">101</span><span class="sc">:</span>n.vec[<span class="dv">1</span>], <span class="at">l1=</span>l1)</span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a>                  <span class="cf">if</span>(size.A0 <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> size.A0<span class="sc">&lt;</span> M){</span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a>                    Rank.re.sp <span class="ot">&lt;-</span> (<span class="fu">sum</span>(prop.sp.re1<span class="sc">$</span>rank.pi[<span class="dv">1</span><span class="sc">:</span>size.A0]<span class="sc">&lt;=</span>size.A0) <span class="sc">+</span></span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a>                                     <span class="fu">sum</span>(prop.sp.re2<span class="sc">$</span>rank.pi[<span class="dv">1</span><span class="sc">:</span>size.A0]<span class="sc">&lt;=</span>size.A0))<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>size.A0</span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a>                  }<span class="cf">else</span>{ Rank.re.sp <span class="ot">&lt;-</span><span class="dv">1</span> }</span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a>                  beta.sp <span class="ot">&lt;-</span> (prop.sp.re1<span class="sc">$</span>beta.sp <span class="sc">+</span> prop.sp.re2<span class="sc">$</span>beta.sp) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a>                  mse.vec[<span class="dv">4</span>] <span class="ot">=</span> <span class="fu">mse.fun</span>(beta.sp,beta0,X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">$</span>est.err</span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a>                  </span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a>                  <span class="do">######another method for comparison: it is the same as Trans-Lasso except</span></span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a>                  <span class="do">##that the bias correction step (step 2 of Oracle Trans-Lasso) is omitted</span></span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a>                  beta.pool<span class="ot">&lt;-</span>(prop.re1<span class="sc">$</span>beta.pool<span class="sc">+</span>prop.re2<span class="sc">$</span>beta.pool)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a>                  mse.vec[<span class="dv">5</span>] <span class="ot">=</span> <span class="fu">mse.fun</span>(beta.pool,beta0,X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">$</span>est.err</span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a>                  <span class="do">#####naive translasso: simply assumes A0=1:K</span></span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a>                  beta.all <span class="ot">&lt;-</span> <span class="fu">las.kA</span>(X, y, <span class="at">A0 =</span> <span class="dv">1</span><span class="sc">:</span>M, <span class="at">n.vec =</span> n.vec, <span class="at">l1=</span>l1)<span class="sc">$</span>beta.kA<span class="co">#naive transLasso</span></span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a>                  mse.vec[<span class="dv">6</span>] <span class="ot">=</span> <span class="fu">mse.fun</span>(<span class="fu">as.numeric</span>(beta.all),beta0,X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">$</span>est.err</span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;Trans-LASSO:&#39;</span>,mse.vec,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a><span class="co">#&gt; Trans-LASSO: 1.124101 1.124101 1.120701 0.823419 0.8698759 0.5743772 NA NA</span></span></code></pre></div>
</div>
<div id="sa24204174" class="section level2">
<h2>SA24204174</h2>
<p>Begin transfer learning with TranSIM.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>                  L <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">sqrt</span>(<span class="fu">t</span>(beta0)<span class="sc">%*%</span>Sig.X<span class="sc">%*%</span>beta0))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                  X1<span class="ot">&lt;-</span>X</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                  y1<span class="ot">&lt;-</span>y</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                  <span class="co">#if(nums &lt; 6) next</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                  u0 <span class="ot">&lt;-</span> <span class="fu">un</span>(X[<span class="dv">1</span><span class="sc">:</span>n.vec[<span class="dv">1</span>],],y[<span class="dv">1</span><span class="sc">:</span>n.vec[<span class="dv">1</span>]])</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                  Us <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,p<span class="sc">*</span>(M<span class="sc">+</span><span class="dv">1</span>)),p,M<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                    inde <span class="ot">&lt;-</span> (n.vec[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>(i<span class="dv">-1</span>)<span class="sc">*</span>(n.vec[i<span class="sc">+</span><span class="dv">1</span>]))<span class="sc">:</span>(n.vec[<span class="dv">1</span>]<span class="sc">+</span>i<span class="sc">*</span>n.vec[i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>                    Us[, i] <span class="ot">&lt;-</span> <span class="fu">un</span>(X[inde,],y[inde])</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>                  }</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>                  Us[,M<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> u0</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>                  u_source1<span class="ot">=</span><span class="fu">rep</span>(<span class="fl">1.2</span>,p)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>                  u_source11 <span class="ot">&lt;-</span> u_source1</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>                  u_source11[<span class="dv">1</span>]<span class="ot">=</span><span class="sc">-</span><span class="dv">1</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>                  <span class="co">#next</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>                  <span class="co">#if(size.A0 ==4) return(list(X=X,y=y))</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>                  dimx <span class="ot">&lt;-</span> p</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>                  record<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">1</span>,p)</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>                  beta_source_sum <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,p)</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>                  beta_source_sum1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,p)</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>                  beta_source_sum2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,p)</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>                  beta_sum_all <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,p<span class="sc">*</span>(M<span class="sc">+</span><span class="dv">1</span>)),p,M<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>                  dimx <span class="ot">&lt;-</span> <span class="fu">length</span>(beta_source_sum)</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>                  lambda_temp <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>                  </span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>                  </span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>                  p_ini <span class="ot">&lt;-</span> <span class="fu">c</span>(p_ini,p)</span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>                  wudi_num <span class="ot">&lt;-</span> <span class="fl">0.0</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>                  </span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;第一次循环：&#39;</span>,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt; 第一次循环：</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>                  <span class="co">#cat(&#39;beta:&#39;,length(beta0),&#39;\n&#39;)</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a>                  <span class="fu">system.time</span>({</span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a>                    cl<span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">1</span>)</span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>                    <span class="fu">registerDoParallel</span>(cl)       <span class="co">#进行进程注册</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>                    beta_sum_all <span class="ot">&lt;-</span> <span class="fu">foreach</span>(</span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a>                      <span class="at">i=</span><span class="dv">1</span><span class="sc">:</span>M,          <span class="co">#输入等待请求的参数</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>                      <span class="at">.combine=</span>cbind,  <span class="co">#返回结果的整合</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a>                      <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">&quot;SA24204174&quot;</span>)</span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a>                      <span class="co">#多个进程共享的系统环境</span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a>                    ) <span class="sc">%dopar%</span> {</span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a>                      an <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a>                        <span class="fu">log</span>(<span class="fu">log</span>(n))<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a>                      }</span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a>                      inde <span class="ot">&lt;-</span> (n0 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">+</span> (i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> n_s)<span class="sc">:</span>(n0 <span class="sc">+</span> i <span class="sc">*</span> n_s)</span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a>                      lambda_temp <span class="ot">&lt;-</span> SA24204174<span class="sc">::</span><span class="fu">gic_select</span>(<span class="fu">seq</span>(<span class="fl">0.065</span>, <span class="fl">0.076</span>, <span class="fl">0.001</span>), Us[, i], <span class="fu">cov</span>(X[inde, ]), n_s,dimx,an, u_source1, <span class="fu">rep</span>(<span class="dv">0</span>, dimx), <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">abs</span>(u_source1)), <span class="at">s=</span><span class="dv">0</span>,<span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a>                      </span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a>                      kuso <span class="ot">&lt;-</span> SA24204174<span class="sc">::</span><span class="fu">lmrc_lasso</span>(dimx, dimx, <span class="fu">cov</span>(X[inde, ]), L, <span class="dv">0</span>, Us[, i], u_source1, <span class="fu">rep</span>(<span class="dv">0</span>, dimx), <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">abs</span>(u_source11)), lambda_temp, <span class="fl">0.11</span>, <span class="fl">2e2</span>, <span class="fl">1e-6</span>)</span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a>                      <span class="co">#kuso = kuso * (abs(kuso) &gt; wudi_num)</span></span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a>                      kuso <span class="ot">&lt;-</span> kuso <span class="sc">/</span> <span class="fu">as.numeric</span>(<span class="fu">sqrt</span>(<span class="fu">t</span>(kuso) <span class="sc">%*%</span> <span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0, ]) <span class="sc">%*%</span> kuso))</span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a>                      <span class="fu">return</span>(kuso)</span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a>                    }</span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a>                  })</span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a><span class="co">#&gt;    user  system elapsed </span></span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a><span class="co">#&gt;    0.01    0.02  140.61</span></span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a>                  </span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a>                  <span class="co">#cat(beta_sum_all,&#39;\n&#39;)</span></span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a>                  an <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a>                    <span class="fu">log</span>(<span class="fu">log</span>(n))<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a>                  }</span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a>                  inde <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n0</span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a>                  lambda_temp <span class="ot">&lt;-</span> SA24204174<span class="sc">::</span><span class="fu">gic_select</span>(<span class="fu">seq</span>(<span class="fl">0.055</span>, <span class="fl">0.088</span>, <span class="fl">0.001</span>), Us[, i], <span class="fu">cov</span>(X[inde, ]), n_s,dimx,an, u_source1, <span class="fu">rep</span>(<span class="dv">0</span>, dimx), <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">abs</span>(u_source1)), <span class="at">s=</span><span class="dv">1</span>)</span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a>                  kuso1 <span class="ot">&lt;-</span> SA24204174<span class="sc">::</span><span class="fu">lmrc_lasso</span>(dimx, dimx, <span class="fu">cov</span>(X[inde, ]), L, <span class="dv">1</span>, u0, u_source1, <span class="fu">rep</span>(<span class="dv">0</span>, dimx), <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">abs</span>(u_source1)), lambda_temp, <span class="fl">0.11</span>, <span class="fl">2e2</span>, <span class="fl">1e-6</span>)</span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a>                  beta_fit <span class="ot">&lt;-</span> kuso1<span class="sc">*</span>(<span class="fu">as.numeric</span>(kuso1<span class="sc">%*%</span><span class="fu">t</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">%*%</span>y[<span class="dv">1</span><span class="sc">:</span>n0])<span class="sc">/</span><span class="fu">as.numeric</span>(kuso1<span class="sc">%*%</span><span class="fu">t</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">%*%</span>X[<span class="dv">1</span><span class="sc">:</span>n0,]<span class="sc">%*%</span>kuso1))</span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;target_only:&#39;</span>,<span class="fu">sum</span>((beta_fit<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a><span class="co">#&gt; target_only: 1.135847</span></span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a>                  sse_target_only <span class="ot">&lt;-</span> <span class="fu">c</span>(sse_target_only,<span class="fu">sum</span>((beta_fit<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a>                  beta_target <span class="ot">&lt;-</span> beta_fit</span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a>                  iter_times_num <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a>                  fp_target <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_target,<span class="fu">fp</span>(beta_fit,beta0))</span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a>                  fn_target <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_target,<span class="fu">fn</span>(beta_fit,beta0))</span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a>                  </span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a>                  </span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a>                  </span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a>                  </span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a>                  </span>
<span id="cb4-77"><a href="#cb4-77" tabindex="-1"></a>                  </span>
<span id="cb4-78"><a href="#cb4-78" tabindex="-1"></a>                  </span>
<span id="cb4-79"><a href="#cb4-79" tabindex="-1"></a>                  <span class="do">## ini weighting</span></span>
<span id="cb4-80"><a href="#cb4-80" tabindex="-1"></a>                  </span>
<span id="cb4-81"><a href="#cb4-81" tabindex="-1"></a>                  prior <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,M)</span>
<span id="cb4-82"><a href="#cb4-82" tabindex="-1"></a>                  sigmab <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">t</span>(beta_sum_all)<span class="sc">%*%</span><span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>,])<span class="sc">%*%</span>beta_sum_all)</span>
<span id="cb4-83"><a href="#cb4-83" tabindex="-1"></a>                  prior <span class="ot">&lt;-</span> <span class="fu">betascale</span>(prior,sigmab)</span>
<span id="cb4-84"><a href="#cb4-84" tabindex="-1"></a>                  <span class="co">#priors &lt;- rep(1,36)</span></span>
<span id="cb4-85"><a href="#cb4-85" tabindex="-1"></a>                  <span class="co">#prior&lt;-priors[(2*nums-1):(2*nums)]</span></span>
<span id="cb4-86"><a href="#cb4-86" tabindex="-1"></a>                  <span class="co">#cat(&#39;prior:&#39;,prior,&#39;\n&#39;)</span></span>
<span id="cb4-87"><a href="#cb4-87" tabindex="-1"></a>                  <span class="co">#prior &lt;- c(rep(prior[2],size.A0),rep(prior[1],M-size.A0))</span></span>
<span id="cb4-88"><a href="#cb4-88" tabindex="-1"></a>                  beta_cal<span class="ot">&lt;-</span><span class="fu">numeric</span>(p)</span>
<span id="cb4-89"><a href="#cb4-89" tabindex="-1"></a>                  <span class="cf">if</span>(<span class="fu">is.singular.matrix</span>(sigmab)){</span>
<span id="cb4-90"><a href="#cb4-90" tabindex="-1"></a>                    <span class="fu">cat</span>(<span class="st">&#39;weixian,no inverse!!!!&#39;</span>,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-91"><a href="#cb4-91" tabindex="-1"></a>                  }</span>
<span id="cb4-92"><a href="#cb4-92" tabindex="-1"></a>                  </span>
<span id="cb4-93"><a href="#cb4-93" tabindex="-1"></a>                  <span class="cf">if</span>(size.A0 <span class="sc">&lt;=</span><span class="dv">4</span>){</span>
<span id="cb4-94"><a href="#cb4-94" tabindex="-1"></a>                    gred_lambda <span class="ot">&lt;-</span> <span class="fu">lambda_cross</span>(prior,X[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>,],y[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>],beta_sum_all,<span class="fu">seq</span>(<span class="fl">1.3</span>,<span class="dv">2</span>,<span class="fl">0.1</span>),<span class="dv">5</span>,<span class="dv">3</span>)</span>
<span id="cb4-95"><a href="#cb4-95" tabindex="-1"></a>                  }<span class="cf">else</span>{</span>
<span id="cb4-96"><a href="#cb4-96" tabindex="-1"></a>                    gred_lambda <span class="ot">&lt;-</span> <span class="fu">lambda_cross</span>(prior,X[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>,],y[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>],beta_sum_all,<span class="fu">seq</span>(<span class="fl">1.1</span>,<span class="fl">2.0</span>,<span class="fl">0.1</span>),<span class="dv">5</span>,<span class="dv">3</span>)</span>
<span id="cb4-97"><a href="#cb4-97" tabindex="-1"></a>                  }</span>
<span id="cb4-98"><a href="#cb4-98" tabindex="-1"></a><span class="co">#&gt; lambda_score: 1 2 3 4 5 6 7 8</span></span>
<span id="cb4-99"><a href="#cb4-99" tabindex="-1"></a>                  weight_temp <span class="ot">&lt;-</span> <span class="fu">weight_cos</span>(prior,sigmab,u0,beta_sum_all,gred_lambda)</span>
<span id="cb4-100"><a href="#cb4-100" tabindex="-1"></a>                  kuso1<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(beta_sum_all<span class="sc">%*%</span>weight_temp)</span>
<span id="cb4-101"><a href="#cb4-101" tabindex="-1"></a>                  kuso1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(kuso1)</span>
<span id="cb4-102"><a href="#cb4-102" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;weight_ini:&#39;</span>,weight_temp,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-103"><a href="#cb4-103" tabindex="-1"></a><span class="co">#&gt; weight_ini: 0.09703871 0.01754339 0.1917125 0.09813966 0.1281059 0.1879369 0.09320632 0.07706435 0.1410091 0.09546113 0.1643212 0.1226599 0.1916896 0.1556684 0.1331703 0.03602376 0.1249977 0.10568 0.1730371 0.1403392</span></span>
<span id="cb4-104"><a href="#cb4-104" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;gred_lambda:&#39;</span>,gred_lambda,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>,<span class="st">&#39;ini_kuso1:&#39;</span>,kuso1,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-105"><a href="#cb4-105" tabindex="-1"></a><span class="co">#&gt; gred_lambda: 1.3 </span></span>
<span id="cb4-106"><a href="#cb4-106" tabindex="-1"></a><span class="co">#&gt;  ini_kuso1: -0.540666 0.08791512 0.1823737 0.1587224 0.07906449 0.1377079 0.1900887 0.104649 0.1055597 0.1648808 0.1881071 0.06689768 0.0838657 0.0457058 0.06233764 0.07998801 0.03357272 0.02814742 -0.001668051 0.04212036 0.001907247 -3.822685e-05 0.04279304 0.01752188 0.05264858 -0.003599596 0.02963887 0.006867053 0.08250653 0.05971856 0.01110396 0.01711503 0.0237608 0.01497391 0 0.007287877 0.0149572 0 0.03257649 0.08046118 -0.001974328 0 0.01324552 0.004864829 0.05099648 -0.01625718 0.03183427 0.01328363 -0.02397285 0.01781441 0.02307198 0 0.01636567 0.01222565 0.02951517 0.01112658 0.00767723 0.0004108606 0.04981662 -0.01374381 0.009518293 0.001885014 0.01326824 -0.0008560867 0 -0.00280875 -0.004237949 0.004642706 -0.02333359 0.004317119 0.03484226 0.0166289 0.001743226 0.03573205 0.01816711 -0.001743285 0.02036429 0.01526618 0.03705318 0 0.04609506 -0.01802134 0.02817508 -0.009440467 0.06143365 0.01994736 -0.01715317 0.001225115 0.03227057 -0.002875321 0.03762685 0.001504874 0.01634981 0.01336975 0.01090968 0.002816773 0.01232328 -0.0001231451 0 0.02993397 -0.006151199 -0.04608686 0.02505216 0.05430135 0.009890485 -0.002692989 0.002599384 0 0.01199071 0.05178687 0.008397482 -0.0173969 -0.002128372 -0.004477874 0.006620547 0.001516379 0.008136549 0.02431862 0.01130402 0.01519571 0.01837927 0.02971002 0.01994843 0 0.01523561 0.0283032 0.013617 0.0068732 0.06301022 0.1142505 -0.01124897 -0.004223445 0.01422313 0.0449475 0.03627782 0.03662339 0.03161448 0.05659976 0.01596751 0.01505557 0.0147397 0.02159216 0 0.0005171391 0.01912699 0.02921761 0.00542485 0.007278653 0.004844626 -0.000335139 0.02424677 0.009778976 0.009361957 0.00702577 0.05174643 -0.03899821 0.01375644 0.05231313 0.03282258 0.04417098 -1.433061e-05 0.01809316 -0.003253662 0.07583982 0.02440057 -0.02579472 0.03758128 0.02844947 0.02062691 0.06560919 0 0.04580559 0.04295118 0.007309611 0.01025959 0.008705673 0.03780488 0.03056382 0.0005078872 0.005639404 -0.00395772 0.0190885 0.01037782 0.02515228 -0.00974657 -0.02570201 -0.007313694 0.002826846 0.01123019 0.06034787 0.012498 0.009523241 0.01420448 0 0.01065148 0.002987688 -0.005021091 -0.006507886 0.01122083 -0.0002181432 -0.01438581 -0.003841201 0.005302773 0.006582581 0.02449894 0.005104073 0.005518213 0.02160354 0.02871642 0.005182506 0.003196143 0.00997317 -0.0001912023 0.03937536 0.05354721 0.02514832 0.0340749 -0.01276865 0.03698358 0.004000005 0.03786788 0.002605772 0.02624742 0.05348333 0.009815162 0.01912386 0.0391992 0.04914696 0.05509849 0.03532006 0.009414891 0.009457894 0.01285356 0.01856281 -0.0003618183 0.002366224 0.02492945 0.008652443 0.04205828 0.0233164 0.009520481 0.05379405 -0.0358095 0.03217836 -0.000606329 0.03458872 0.01284781 0.03997017 0.07207826 0.02113632 -0.005176291 0.01778233 -0.0002218319 0.01790019 0.01474299 -0.007584851 0.002651506 -0.0238452 0.05870361 -0.0001182031 -0.01072583 0.01723074 0.04524822 0.110418 0.00462762 0.05462197 0.006876457 0.03137395 0 0.05894942 0.00380974 0.006977817 0.01910245 0.04072613 0.05858002 -0.003912886 0.02015472 0.02006735 0.01843854 -0.006737393 0.01488948 -0.002888419 0.01568228 0.002570507 0.01402331 0.03802369 0.003466654 0.05303127 0.01616283 0.01535153 -0.009106249 0.0213582 0.003600749 -0.001610013 0.01401988 0.003051614 0.03793881 -0.03740756 0 -0.008430128 -0.05259992 0.02010967 0.003226119 -0.001339209 0.01978172 0.00820965 0.01667782 0.01707869 -0.001024141 0.04451236 0.0709833 0.03202859 0.01091204 -0.01180277 0.01239578 0.04054261 0.02212575 0.008981263 0.03255343 0.0696273 0.05278541 0.0189146 0.01459288 0.007396866 0.01982077 -0.02106168 0.02429113 0.08178756 0.002755235 0.04993652 0.02334645 0.01981176 0.03275449 0.02807225 0.007935909 0.03579127 0.03866168 -0.03251871 0.002929856 -0.008083104 0.02991025 0.01708805 0.001754828 0.01823706 0.0135297 0.01009172 -0.01245034 -0.0005943121 0.006126613 -0.002281057 0.04220564 0.02915102 0.0117976 0.04599812 -8.768528e-05 0 0.005821644 -0.003736729 0.02716894 0.009844502 0.05706689 0.004959913 0.03629417 0.007618357 0.005396389 0.01692852 0.01360945 -0.001945527 0.02347067 0.00983858 0.01342242 0.01727161 0.06629413 -0.01183541 0.02940461 -0.02478011 0.06755388 0.04770339 0.01746138 -0.004674833 0.01749137 0.0009914264 -0.001158683 -0.001206435 0.01491813 -0.009486124 0.01657446 0.01071606 -0.02093535 0.04556508 2.744699e-05 -5.780373e-06 0.009783364 -0.000186638 0 0.05492759 0.04805022 -0.01247194 0.04341431 -0.003203891 0.02723697 0.04697602 0.01142196 6.895975e-07 0.0331925 0.02439094 0.03313261 -0.002594234 -0.002119055 0.01721218 0.01801302 0.01670375 0.05631274 -0.007177171 0.04577878 -0.007412193 0.0122926 0.006852934 -2.715264e-05 0.03203532 0.02982538 -0.00370074 -0.006642637 0.001405165 0.01198144 -8.260385e-05 0.01517653 0 0.0276404 -0.009927019 0.05298893 0.003067386 -0.0003073721 0.003624792 0.003680925 0.01957397 0.003487486 0.01298653 0.02554606 0.04139802 0.04198112 0.006073546 0.005223105 0.00883828 -0.01116888 0.01727235 0.008661341 0.04388128 -0.02497708 0.01571489 0.0525395 0.03933759 0.003949962 0.01385579 0.002671649 0.03693017 -0.003115003 -0.001762428 0.02607145 0.03810782 0.03708858 0.01440138 0.001817589 -0.004330299 -0.03230998 0.04043861 0.0306491 -0.01013354 0.01550786 -0.003924307 0.01471599 0.01084751 0.01562424 0.01698453 -0.000204226 0.01163428 0.02673064 0.005218762 0.01065591 0.03621375 0.01940396 0.02651101 -0.009336307 0.008100949 0.0128797 -0.0002457294 0.04367798 0.01223781 0.001174063 -0.0212463 -0.0005392308 -0.003504516 0.0559411 0.006445751 0.02288093 0.003081101 0.01968339 0.01775261 0.002494288 -0.01077349</span></span>
<span id="cb4-107"><a href="#cb4-107" tabindex="-1"></a>                  weight_beifen <span class="ot">&lt;-</span> weight_temp</span>
<span id="cb4-108"><a href="#cb4-108" tabindex="-1"></a>                  </span>
<span id="cb4-109"><a href="#cb4-109" tabindex="-1"></a>                  an <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb4-110"><a href="#cb4-110" tabindex="-1"></a>                    <span class="fu">log</span>(<span class="fu">log</span>(n))</span>
<span id="cb4-111"><a href="#cb4-111" tabindex="-1"></a>                  }</span>
<span id="cb4-112"><a href="#cb4-112" tabindex="-1"></a>                  <span class="co">#if(size.A0==0){</span></span>
<span id="cb4-113"><a href="#cb4-113" tabindex="-1"></a>                  <span class="co">#kiu &lt;- debias_gic_select(rbind(expand.grid(0.5,seq(0.05,0.1,0.01),seq(0.008,0.013,0.001)),expand.grid(1,seq(0.05,0.05,0.01),seq(0.001,min(0.005,0.002+size.A0/8*0.001),0.001)),expand.grid(2,seq(0.02,0.05,0.01),seq(0.00001,0.00005+size.A0/8*0.00001,0.00001))),n0,an,u0,cov(X[1:n0,]),dimx,rep(1,dimx),kuso1,rep(1,dimx),1,1.2,0.21,2e2,1e-6)</span></span>
<span id="cb4-114"><a href="#cb4-114" tabindex="-1"></a>                  <span class="co">#}else{</span></span>
<span id="cb4-115"><a href="#cb4-115" tabindex="-1"></a>                  <span class="co">#  if(size.A0==4){</span></span>
<span id="cb4-116"><a href="#cb4-116" tabindex="-1"></a>                  <span class="co">#    kiu &lt;- debias_gic_select(rbind(expand.grid(0.5,seq(0.05,0.1,0.01),seq(0.008,0.01,0.001)),expand.grid(1,seq(0.05,0.05,0.01),seq(0.001,0.002,0.0005)),expand.grid(2,seq(0.02,0.05,0.01),seq(0.00001,0.00004,0.00001))),n0,an,u0,cov(X[1:n0,]),dimx,rep(1,dimx),kuso1,rep(1,dimx),1,1.2,0.21,2e2,1e-6)</span></span>
<span id="cb4-117"><a href="#cb4-117" tabindex="-1"></a>                  <span class="co">#  }else{</span></span>
<span id="cb4-118"><a href="#cb4-118" tabindex="-1"></a>                  <span class="co">#  kiu &lt;- debias_gic_select(rbind(expand.grid(0.5,seq(0.05,0.1,0.01),seq(0.008,0.013,0.001)),expand.grid(1,seq(0.05,0.05,0.01),seq(0.001,min(0.005,0.002+size.A0/8*0.001),0.001)),expand.grid(2,seq(0.02,0.05,0.01),seq(0.00001,0.00004+size.A0/8*0.00001,0.00001))),n0,an,u0,cov(X[1:n0,]),dimx,rep(1,dimx),kuso1,rep(1,dimx),1,1.2,0.21,2e2,1e-6)</span></span>
<span id="cb4-119"><a href="#cb4-119" tabindex="-1"></a>                  <span class="co">#  }</span></span>
<span id="cb4-120"><a href="#cb4-120" tabindex="-1"></a>                  <span class="co">#}</span></span>
<span id="cb4-121"><a href="#cb4-121" tabindex="-1"></a>                  <span class="cf">if</span>(size.A0<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb4-122"><a href="#cb4-122" tabindex="-1"></a>                    kiu <span class="ot">&lt;-</span> <span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.005</span>,<span class="fl">0.012</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0005</span>,<span class="fl">0.0025</span>,<span class="fl">0.0005</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.00002</span>,<span class="fl">0.00005</span>,<span class="fl">0.00001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-123"><a href="#cb4-123" tabindex="-1"></a>                  }<span class="cf">else</span> <span class="cf">if</span>(size.A0<span class="sc">==</span><span class="dv">4</span>){</span>
<span id="cb4-124"><a href="#cb4-124" tabindex="-1"></a>                    kiu <span class="ot">&lt;-</span> <span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.005</span>,<span class="fl">0.012</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0005</span>,<span class="fl">0.0025</span>,<span class="fl">0.0005</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.00002</span>,<span class="fl">0.00005</span>,<span class="fl">0.00001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-125"><a href="#cb4-125" tabindex="-1"></a>                  }<span class="cf">else</span> <span class="cf">if</span>(size.A0<span class="sc">==</span><span class="dv">8</span>){</span>
<span id="cb4-126"><a href="#cb4-126" tabindex="-1"></a>                    kiu <span class="ot">&lt;-</span> <span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.005</span>,<span class="fl">0.012</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0005</span>,<span class="fl">0.0025</span>,<span class="fl">0.0005</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.00002</span>,<span class="fl">0.00005</span>,<span class="fl">0.00001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-127"><a href="#cb4-127" tabindex="-1"></a>                  }<span class="cf">else</span> <span class="cf">if</span>(size.A0<span class="sc">==</span><span class="dv">12</span>){</span>
<span id="cb4-128"><a href="#cb4-128" tabindex="-1"></a>                    kiu <span class="ot">&lt;-</span> <span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.012</span>,<span class="fl">0.015</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0015</span>,<span class="fl">0.0026</span>,<span class="fl">0.0005</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.00002</span>,<span class="fl">0.00005</span>,<span class="fl">0.00001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-129"><a href="#cb4-129" tabindex="-1"></a>                  }<span class="cf">else</span> <span class="cf">if</span>(size.A0<span class="sc">&gt;=</span><span class="dv">16</span>){</span>
<span id="cb4-130"><a href="#cb4-130" tabindex="-1"></a>                    kiu <span class="ot">&lt;-</span> <span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.005</span>,<span class="fl">0.012</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0005</span>,<span class="fl">0.0025</span>,<span class="fl">0.0005</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.00002</span>,<span class="fl">0.00005</span>,<span class="fl">0.00001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-131"><a href="#cb4-131" tabindex="-1"></a>                  }<span class="cf">else</span>{</span>
<span id="cb4-132"><a href="#cb4-132" tabindex="-1"></a>                    kiu <span class="ot">&lt;-</span> <span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.005</span>,<span class="fl">0.012</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0005</span>,<span class="fl">0.0025</span>,<span class="fl">0.0005</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.00002</span>,<span class="fl">0.00005</span>,<span class="fl">0.00001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-133"><a href="#cb4-133" tabindex="-1"></a>                  }</span>
<span id="cb4-134"><a href="#cb4-134" tabindex="-1"></a><span class="co">#&gt; last_gamma: 2 last_lambda1: 0.02 last_lambda2: 5e-05 gic_max: -0.4173807</span></span>
<span id="cb4-135"><a href="#cb4-135" tabindex="-1"></a>                  <span class="co">#if(nums==19) return(list(X,y,prior))</span></span>
<span id="cb4-136"><a href="#cb4-136" tabindex="-1"></a>                  beta_cal <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,p)</span>
<span id="cb4-137"><a href="#cb4-137" tabindex="-1"></a>                  beta_cal[<span class="fu">as.logical</span>(record)] <span class="ot">=</span> kiu</span>
<span id="cb4-138"><a href="#cb4-138" tabindex="-1"></a>                  </span>
<span id="cb4-139"><a href="#cb4-139" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;mse.ini:&#39;</span>,<span class="fu">sum</span>((beta_cal<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-140"><a href="#cb4-140" tabindex="-1"></a><span class="co">#&gt; mse.ini: 0.4751856</span></span>
<span id="cb4-141"><a href="#cb4-141" tabindex="-1"></a>                  </span>
<span id="cb4-142"><a href="#cb4-142" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;ini_kiu:&#39;</span>,kiu,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-143"><a href="#cb4-143" tabindex="-1"></a><span class="co">#&gt; ini_kiu: 0.1196844 0.4400964 0.1298831 0.3449673 0.2682404 0.3565444 0.3272225 0.2089547 0.2114928 0.2083579 0.3863726 0.08044865 0.1563546 0.1600313 0.2269619 0.3495761 0 0.03384904 0 0 0 0 0 0 0 0 0 0 0.05061193 0.07181532 0 0 0 0 0 0 0 0 0 0.09675962 0 0 0 0 0.06132647 0 0.0382827 0 0 0 0 0 0 0 0 0 0 0 0.02198865 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.0493296 0 0 0 0.0719248 0 0 0 0.002077393 0 0 0 0 0 0 0 0 0 0 0 0 0.1486486 0 0 0 0 0 0 0 0.03603824 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.05540856 -0.03555954 0 0 0 0.01940088 0.04362635 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.06290982 0.03947122 0.03269897 0 0 0 -0.01491741 0 0 0.1097053 0.03421227 0 -0.002901353 0 0 -0.000658251 0 0 0 0.0004869155 0 0 0 0 0 0 0 0 0 0 0 0 0.02068592 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.04447507 0 0.0455385 0 0 0 0 0 0.02292508 0.05867553 0.06625939 0.007839349 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.02087318 0 -0.01257629 0.08667863 0 0 0 0 0 0 0 0 0 0.07059478 0 0 0 0 0.2070741 0 0.1572966 0 0 0 0 0 0 0 0 0.03280704 0 0 0 0 0 0 0 0 0 0 0.02263783 0 0.03098613 0 0 0 0 0 0 0 0 0.01358333 0 0 0 0.03290371 0 0 0 0 0 0 0 0 0.05352891 0 0.03851639 0 0 0 0.04875503 0 0 0 0.05692553 0 0 0 0 0 0 0 0.09835467 0 0.0600518 0 0 0 0 0 -0.02562829 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.03428889 0 0 0 0 0 0 0.04539957 0 0.005664654 0 0 0 0 0 0 0 0 0 0.1215402 0 0 0 0.08123778 0.05736632 0 0 0 0 0 0 0 0 0 0 0 0.04107471 0 0 0 0 0 0.02167892 0.05432773 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.01253405 0 0 0 0 0 0 0 0.03430304 0 0 0 0 0 0 0 0 0 0.06372251 0 0 0 0 0 0 0 0 0.04978372 0.04537499 0 0 0 0 0 0 0.01968392 0 0 0.1024482 0 0 0 0 0.003384278 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.0435493 0 0 0 0 0 0 0.0161364 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span id="cb4-144"><a href="#cb4-144" tabindex="-1"></a>                  </span>
<span id="cb4-145"><a href="#cb4-145" tabindex="-1"></a>                  mymse_l2_ini <span class="ot">&lt;-</span> <span class="fu">c</span>(  mymse_l2_ini , <span class="fu">sum</span>((beta_cal<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-146"><a href="#cb4-146" tabindex="-1"></a>                  </span>
<span id="cb4-147"><a href="#cb4-147" tabindex="-1"></a>                  </span>
<span id="cb4-148"><a href="#cb4-148" tabindex="-1"></a>                  kuso1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.logical</span>(kiu))<span class="sc">*</span><span class="fl">0.15</span></span>
<span id="cb4-149"><a href="#cb4-149" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;kuso1:&#39;</span>,<span class="fu">length</span>(kuso1),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-150"><a href="#cb4-150" tabindex="-1"></a><span class="co">#&gt; kuso1: 500</span></span>
<span id="cb4-151"><a href="#cb4-151" tabindex="-1"></a>                  fp_ini <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_ini,<span class="fu">fp</span>(kuso1,beta0))</span>
<span id="cb4-152"><a href="#cb4-152" tabindex="-1"></a>                  fn_ini <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_ini,<span class="fu">fn</span>(kuso1,beta0))</span>
<span id="cb4-153"><a href="#cb4-153" tabindex="-1"></a>                  </span>
<span id="cb4-154"><a href="#cb4-154" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;ini_fn:&#39;</span>,<span class="fu">fn</span>(kuso1,beta0),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-155"><a href="#cb4-155" tabindex="-1"></a><span class="co">#&gt; ini_fn: 0</span></span>
<span id="cb4-156"><a href="#cb4-156" tabindex="-1"></a>                  </span>
<span id="cb4-157"><a href="#cb4-157" tabindex="-1"></a>                  </span>
<span id="cb4-158"><a href="#cb4-158" tabindex="-1"></a>                  l1_signal <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-159"><a href="#cb4-159" tabindex="-1"></a>                  </span>
<span id="cb4-160"><a href="#cb4-160" tabindex="-1"></a>                  </span>
<span id="cb4-161"><a href="#cb4-161" tabindex="-1"></a>                  dimx_temp <span class="ot">&lt;-</span> dimx <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-162"><a href="#cb4-162" tabindex="-1"></a>                  </span>
<span id="cb4-163"><a href="#cb4-163" tabindex="-1"></a>                  </span>
<span id="cb4-164"><a href="#cb4-164" tabindex="-1"></a>                  </span>
<span id="cb4-165"><a href="#cb4-165" tabindex="-1"></a>                  iter_pp <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb4-166"><a href="#cb4-166" tabindex="-1"></a>                  </span>
<span id="cb4-167"><a href="#cb4-167" tabindex="-1"></a>                  </span>
<span id="cb4-168"><a href="#cb4-168" tabindex="-1"></a>                  iter_l1_true <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-169"><a href="#cb4-169" tabindex="-1"></a>                  iter_sqrt <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-170"><a href="#cb4-170" tabindex="-1"></a>                  iter_l1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-171"><a href="#cb4-171" tabindex="-1"></a>                  <span class="cf">for</span>(zz <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter_pp){</span>
<span id="cb4-172"><a href="#cb4-172" tabindex="-1"></a>                    <span class="fu">cat</span>(<span class="st">&#39;sizea0:&#39;</span>,size.A0,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-173"><a href="#cb4-173" tabindex="-1"></a>                    kuso1<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">as.logical</span>(kiu))<span class="sc">*</span><span class="fl">0.15</span></span>
<span id="cb4-174"><a href="#cb4-174" tabindex="-1"></a>                    <span class="fu">cat</span>(<span class="st">&#39;iter:&#39;</span>,zz,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-175"><a href="#cb4-175" tabindex="-1"></a>                    beta_source_sum<span class="ot">&lt;-</span>kuso1<span class="sc">*</span>(M<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb4-176"><a href="#cb4-176" tabindex="-1"></a>                    beta_cal <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,p)</span>
<span id="cb4-177"><a href="#cb4-177" tabindex="-1"></a>                    record[<span class="fu">which</span>(record<span class="sc">==</span><span class="dv">1</span>)[<span class="fu">which</span>(<span class="fu">abs</span>(beta_source_sum<span class="sc">/</span>(M<span class="sc">+</span><span class="dv">1</span>))<span class="sc">&lt;=</span>wudi_num)]] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb4-178"><a href="#cb4-178" tabindex="-1"></a>                    <span class="fu">cat</span>(<span class="st">&#39;sump:&#39;</span>,<span class="fu">sum</span>(record),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-179"><a href="#cb4-179" tabindex="-1"></a>                    beta0_temp <span class="ot">=</span> beta0[<span class="fu">which</span>(<span class="fu">abs</span>(beta_source_sum<span class="sc">/</span>(M<span class="sc">+</span><span class="dv">1</span>))<span class="sc">&gt;</span>wudi_num)]</span>
<span id="cb4-180"><a href="#cb4-180" tabindex="-1"></a>                    <span class="fu">cat</span>(<span class="st">&#39;dimx&#39;</span>,<span class="fu">dim</span>(X),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-181"><a href="#cb4-181" tabindex="-1"></a>                    <span class="fu">cat</span>(<span class="fu">length</span>(<span class="fu">abs</span>(beta_source_sum<span class="sc">/</span>(M<span class="sc">+</span><span class="dv">1</span>))<span class="sc">&gt;</span>wudi_num),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-182"><a href="#cb4-182" tabindex="-1"></a>                    X<span class="ot">&lt;-</span>X[,<span class="fu">abs</span>(beta_source_sum<span class="sc">/</span>(M<span class="sc">+</span><span class="dv">1</span>))<span class="sc">&gt;</span>wudi_num]</span>
<span id="cb4-183"><a href="#cb4-183" tabindex="-1"></a>                    beta_source_sum <span class="ot">&lt;-</span> beta_source_sum[<span class="fu">abs</span>(beta_source_sum<span class="sc">/</span>(M<span class="sc">+</span><span class="dv">1</span>))<span class="sc">&gt;</span>wudi_num]</span>
<span id="cb4-184"><a href="#cb4-184" tabindex="-1"></a>                    dimx <span class="ot">&lt;-</span> <span class="fu">length</span>(beta_source_sum)</span>
<span id="cb4-185"><a href="#cb4-185" tabindex="-1"></a>                    </span>
<span id="cb4-186"><a href="#cb4-186" tabindex="-1"></a>                    </span>
<span id="cb4-187"><a href="#cb4-187" tabindex="-1"></a>                    </span>
<span id="cb4-188"><a href="#cb4-188" tabindex="-1"></a>                    iter_sqrt <span class="ot">&lt;-</span> iter_sqrt <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-189"><a href="#cb4-189" tabindex="-1"></a>                    lambda_temp <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb4-190"><a href="#cb4-190" tabindex="-1"></a>                    u0 <span class="ot">&lt;-</span> <span class="fu">un</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,],y[<span class="dv">1</span><span class="sc">:</span>n0])</span>
<span id="cb4-191"><a href="#cb4-191" tabindex="-1"></a>                    Us <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,dimx<span class="sc">*</span>(M<span class="sc">+</span><span class="dv">1</span>)),dimx,(M<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb4-192"><a href="#cb4-192" tabindex="-1"></a>                    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(M)){</span>
<span id="cb4-193"><a href="#cb4-193" tabindex="-1"></a>                      inde <span class="ot">&lt;-</span> (n0<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>(i<span class="dv">-1</span>)<span class="sc">*</span>(n_s))<span class="sc">:</span>(n0<span class="sc">+</span>i<span class="sc">*</span>n_s)</span>
<span id="cb4-194"><a href="#cb4-194" tabindex="-1"></a>                      Us[, i] <span class="ot">&lt;-</span> <span class="fu">un</span>(X[inde,],y[inde])</span>
<span id="cb4-195"><a href="#cb4-195" tabindex="-1"></a>                    }</span>
<span id="cb4-196"><a href="#cb4-196" tabindex="-1"></a>                    Us[,M<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> u0</span>
<span id="cb4-197"><a href="#cb4-197" tabindex="-1"></a>                    beta_source_sum1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,dimx)</span>
<span id="cb4-198"><a href="#cb4-198" tabindex="-1"></a>                    beta_sum_all <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,dimx<span class="sc">*</span>(M<span class="sc">+</span><span class="dv">1</span>)),dimx,(M<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb4-199"><a href="#cb4-199" tabindex="-1"></a>                    jiujiu <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-200"><a href="#cb4-200" tabindex="-1"></a>                    <span class="co">#if(iter_sqrt&gt;2){</span></span>
<span id="cb4-201"><a href="#cb4-201" tabindex="-1"></a>                    <span class="co">#  jiujiu &lt;- 1.25</span></span>
<span id="cb4-202"><a href="#cb4-202" tabindex="-1"></a>                    <span class="co">#}</span></span>
<span id="cb4-203"><a href="#cb4-203" tabindex="-1"></a>                    <span class="cf">if</span>(zz <span class="sc">&lt;</span> <span class="dv">60</span>){</span>
<span id="cb4-204"><a href="#cb4-204" tabindex="-1"></a>                      <span class="fu">system.time</span>({</span>
<span id="cb4-205"><a href="#cb4-205" tabindex="-1"></a>                        </span>
<span id="cb4-206"><a href="#cb4-206" tabindex="-1"></a>                        beta_sum_all <span class="ot">&lt;-</span> <span class="fu">foreach</span>(</span>
<span id="cb4-207"><a href="#cb4-207" tabindex="-1"></a>                          <span class="at">i=</span><span class="dv">1</span><span class="sc">:</span>M,          <span class="co">#输入等待请求的参数</span></span>
<span id="cb4-208"><a href="#cb4-208" tabindex="-1"></a>                          <span class="at">.combine=</span>cbind,  <span class="co">#返回结果的整合</span></span>
<span id="cb4-209"><a href="#cb4-209" tabindex="-1"></a>                          <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">&quot;lmrc&quot;</span>)</span>
<span id="cb4-210"><a href="#cb4-210" tabindex="-1"></a>                          <span class="co">#多个进程共享的系统环境</span></span>
<span id="cb4-211"><a href="#cb4-211" tabindex="-1"></a>                        ) <span class="sc">%dopar%</span> {</span>
<span id="cb4-212"><a href="#cb4-212" tabindex="-1"></a>                          an <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb4-213"><a href="#cb4-213" tabindex="-1"></a>                            <span class="fu">log</span>(<span class="fu">log</span>(n))<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb4-214"><a href="#cb4-214" tabindex="-1"></a>                          }</span>
<span id="cb4-215"><a href="#cb4-215" tabindex="-1"></a>                          inde <span class="ot">&lt;-</span> (n0 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">+</span> (i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> n_s)<span class="sc">:</span>(n0 <span class="sc">+</span> i <span class="sc">*</span> n_s)</span>
<span id="cb4-216"><a href="#cb4-216" tabindex="-1"></a>                          lambda_temp <span class="ot">&lt;-</span> SA24204174<span class="sc">::</span><span class="fu">gic_select</span>(<span class="fu">seq</span>(<span class="fl">0.065</span>,<span class="fl">0.135</span>,<span class="fl">0.01</span>)<span class="sc">/</span><span class="dv">3</span><span class="sc">*</span><span class="fu">sqrt</span>(p<span class="sc">/</span><span class="fu">sum</span>(record))<span class="sc">*</span><span class="fl">1.00074</span><span class="sc">^</span>(<span class="fu">sum</span>(record)<span class="sc">-</span>p)<span class="sc">*</span>jiujiu,Us[,i],<span class="fu">cov</span>(X[inde,]),n_s,dimx,an,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="fu">rep</span>(<span class="dv">0</span>,dimx),<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">abs</span>(beta_source_sum)),<span class="sc">-</span><span class="dv">1</span>,<span class="at">alpha=</span><span class="fl">0.21</span>)</span>
<span id="cb4-217"><a href="#cb4-217" tabindex="-1"></a>                          kuso <span class="ot">&lt;-</span> SA24204174<span class="sc">::</span><span class="fu">lmrc_lasso</span>(dimx,dimx,<span class="fu">cov</span>(X[inde,]),L,<span class="sc">-</span><span class="dv">1</span>,Us[,i],<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="fu">rep</span>(<span class="dv">0</span>,dimx),<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">abs</span>(beta_source_sum)),lambda_temp,<span class="fl">0.21</span>,<span class="fl">1e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-218"><a href="#cb4-218" tabindex="-1"></a>                          kuso <span class="ot">&lt;-</span> kuso <span class="sc">/</span> <span class="fu">as.numeric</span>(<span class="fu">sqrt</span>(<span class="fu">t</span>(kuso) <span class="sc">%*%</span> <span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0, ]) <span class="sc">%*%</span> kuso))</span>
<span id="cb4-219"><a href="#cb4-219" tabindex="-1"></a>                          <span class="fu">return</span>(kuso)</span>
<span id="cb4-220"><a href="#cb4-220" tabindex="-1"></a>                        }</span>
<span id="cb4-221"><a href="#cb4-221" tabindex="-1"></a>                      })</span>
<span id="cb4-222"><a href="#cb4-222" tabindex="-1"></a>                      </span>
<span id="cb4-223"><a href="#cb4-223" tabindex="-1"></a>                      </span>
<span id="cb4-224"><a href="#cb4-224" tabindex="-1"></a>                    }<span class="cf">else</span>{</span>
<span id="cb4-225"><a href="#cb4-225" tabindex="-1"></a>                      <span class="fu">stopCluster</span>(cl)</span>
<span id="cb4-226"><a href="#cb4-226" tabindex="-1"></a>                      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb4-227"><a href="#cb4-227" tabindex="-1"></a>                        inde <span class="ot">&lt;-</span> (n0<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>(i<span class="dv">-1</span>)<span class="sc">*</span>(n_s))<span class="sc">:</span>(n0<span class="sc">+</span>i<span class="sc">*</span>n_s)</span>
<span id="cb4-228"><a href="#cb4-228" tabindex="-1"></a>                        </span>
<span id="cb4-229"><a href="#cb4-229" tabindex="-1"></a>                        lambda_temp <span class="ot">&lt;-</span> <span class="fu">gic_select</span>(<span class="fu">c</span>(<span class="fl">0.09</span>,<span class="fl">0.1</span>,<span class="fl">0.115</span>,<span class="fl">0.11</span>,<span class="fl">0.115</span>,<span class="fl">0.12</span>)<span class="sc">/</span><span class="dv">3</span><span class="sc">*</span><span class="fu">sqrt</span>(p<span class="sc">/</span><span class="fu">sum</span>(record))<span class="sc">*</span><span class="fl">1.00075</span><span class="sc">^</span>(<span class="fu">sum</span>(record)<span class="sc">-</span>p)<span class="sc">*</span>jiujiu,Us[,i],<span class="fu">cov</span>(X[inde,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="fu">rep</span>(<span class="dv">0</span>,dimx),<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">abs</span>(beta_source_sum)),<span class="sc">-</span><span class="dv">1</span>,<span class="at">alpha=</span><span class="fl">0.21</span>)</span>
<span id="cb4-230"><a href="#cb4-230" tabindex="-1"></a>                        <span class="co">#cat(lambda_temp,&#39; &#39;)</span></span>
<span id="cb4-231"><a href="#cb4-231" tabindex="-1"></a>                        kuso<span class="ot">&lt;-</span><span class="fu">lmrc_lasso</span>(dimx,dimx,<span class="fu">cov</span>(X[inde,]),L,<span class="sc">-</span><span class="dv">1</span>,Us[,i],<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="fu">rep</span>(<span class="dv">0</span>,dimx),<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">abs</span>(beta_source_sum)),lambda_temp,<span class="fl">0.21</span>,<span class="fl">1e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-232"><a href="#cb4-232" tabindex="-1"></a>                        <span class="co"># kuso&lt;-lmrc_lasso(dimx,dimx,cov(X[1:n0,]),L,0,un(X[1:n0,],y[1:n0]),rep(1,dimx),kuso,rep(1,dimx),0.5,0.11,2e2,1e-6)</span></span>
<span id="cb4-233"><a href="#cb4-233" tabindex="-1"></a>                        <span class="co">#kuso&lt;-lmrc_lasso(dimx,dimx,cov(X[inde,]),L,1,u0,rep(1,dimx),kuso,rep(1,dimx),0.10,0.11,1e2,1e-6)</span></span>
<span id="cb4-234"><a href="#cb4-234" tabindex="-1"></a>                        kuso <span class="ot">&lt;-</span> kuso<span class="sc">/</span><span class="fu">as.numeric</span>(<span class="fu">sqrt</span>(<span class="fu">t</span>(kuso)<span class="sc">%*%</span><span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">%*%</span>kuso))</span>
<span id="cb4-235"><a href="#cb4-235" tabindex="-1"></a>                        <span class="co"># print(beta_source_sum+kuso)</span></span>
<span id="cb4-236"><a href="#cb4-236" tabindex="-1"></a>                        <span class="co">#beta_source_sum &lt;- (beta_source_sum+kuso)</span></span>
<span id="cb4-237"><a href="#cb4-237" tabindex="-1"></a>                        beta_sum_all[,i]<span class="ot">=</span>kuso</span>
<span id="cb4-238"><a href="#cb4-238" tabindex="-1"></a>                        beta_source_sum1 <span class="ot">&lt;-</span> (beta_source_sum1<span class="sc">+</span>kuso)</span>
<span id="cb4-239"><a href="#cb4-239" tabindex="-1"></a>                      }</span>
<span id="cb4-240"><a href="#cb4-240" tabindex="-1"></a>                    }</span>
<span id="cb4-241"><a href="#cb4-241" tabindex="-1"></a>                    </span>
<span id="cb4-242"><a href="#cb4-242" tabindex="-1"></a>                    beta_cal<span class="ot">&lt;-</span><span class="fu">numeric</span>(p)</span>
<span id="cb4-243"><a href="#cb4-243" tabindex="-1"></a>                    <span class="co">#if(size.A0 &lt;=4){</span></span>
<span id="cb4-244"><a href="#cb4-244" tabindex="-1"></a>                    <span class="co">#  gred_lambda &lt;- SA24204174::greedy_cross(1000,as.numeric(prior),X[1:n0,],y[1:n0],as.matrix(beta_sum_all[,1:M]),seq(0.9,1.25,0.01),5,3)</span></span>
<span id="cb4-245"><a href="#cb4-245" tabindex="-1"></a>                    <span class="co">#}</span></span>
<span id="cb4-246"><a href="#cb4-246" tabindex="-1"></a>                    prior <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,M)</span>
<span id="cb4-247"><a href="#cb4-247" tabindex="-1"></a>                    sigmab <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">t</span>(beta_sum_all)<span class="sc">%*%</span><span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>,])<span class="sc">%*%</span>beta_sum_all)</span>
<span id="cb4-248"><a href="#cb4-248" tabindex="-1"></a>                    <span class="cf">if</span>(<span class="fu">is.singular.matrix</span>(sigmab)){</span>
<span id="cb4-249"><a href="#cb4-249" tabindex="-1"></a>                      weight_temp <span class="ot">&lt;-</span> weight_beifen </span>
<span id="cb4-250"><a href="#cb4-250" tabindex="-1"></a>                      kuso1<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(beta_sum_all<span class="sc">%*%</span>weight_temp)</span>
<span id="cb4-251"><a href="#cb4-251" tabindex="-1"></a>                      kuso1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(kuso1)</span>
<span id="cb4-252"><a href="#cb4-252" tabindex="-1"></a>                      kuso1<span class="ot">&lt;-</span><span class="fu">betascale</span>(kuso1,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>,]))</span>
<span id="cb4-253"><a href="#cb4-253" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;weight:&#39;</span>,weight_temp,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-254"><a href="#cb4-254" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;kuso:&#39;</span>,kuso1,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-255"><a href="#cb4-255" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;mse_l2:&#39;</span>,<span class="fu">sum</span>((beta_cal<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-256"><a href="#cb4-256" tabindex="-1"></a>                    }<span class="cf">else</span>{</span>
<span id="cb4-257"><a href="#cb4-257" tabindex="-1"></a>                      prior <span class="ot">&lt;-</span> <span class="fu">betascale</span>(prior,sigmab)</span>
<span id="cb4-258"><a href="#cb4-258" tabindex="-1"></a>                      lambdass <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.02</span>)<span class="sc">*</span><span class="fu">sqrt</span>(p)<span class="sc">/</span><span class="fu">log</span>(<span class="fu">sum</span>(record))<span class="sc">*</span>(zz<span class="sc">^</span><span class="fl">1.62</span>)</span>
<span id="cb4-259"><a href="#cb4-259" tabindex="-1"></a>                      <span class="cf">if</span>(size.A0 <span class="sc">&lt;=</span><span class="dv">4</span>){</span>
<span id="cb4-260"><a href="#cb4-260" tabindex="-1"></a>                        gred_lambda <span class="ot">&lt;-</span> <span class="fu">lambda_cross</span>(prior,X[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>,],y[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>],beta_sum_all,lambdass,<span class="dv">5</span>,<span class="dv">3</span>)</span>
<span id="cb4-261"><a href="#cb4-261" tabindex="-1"></a>                      }<span class="cf">else</span>{</span>
<span id="cb4-262"><a href="#cb4-262" tabindex="-1"></a>                        gred_lambda <span class="ot">&lt;-</span> <span class="fu">lambda_cross</span>(prior,X[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>,],y[<span class="dv">1</span><span class="sc">:</span><span class="dv">150</span>],beta_sum_all,lambdass,<span class="dv">5</span>,<span class="dv">3</span>)</span>
<span id="cb4-263"><a href="#cb4-263" tabindex="-1"></a>                      }</span>
<span id="cb4-264"><a href="#cb4-264" tabindex="-1"></a>                      </span>
<span id="cb4-265"><a href="#cb4-265" tabindex="-1"></a>                      weight_temp <span class="ot">&lt;-</span> <span class="fu">weight_cos</span>(prior,sigmab,u0,beta_sum_all,gred_lambda)</span>
<span id="cb4-266"><a href="#cb4-266" tabindex="-1"></a>                      weight_beifen <span class="ot">&lt;-</span> weight_temp</span>
<span id="cb4-267"><a href="#cb4-267" tabindex="-1"></a>                      kuso1<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(beta_sum_all<span class="sc">%*%</span>weight_temp)</span>
<span id="cb4-268"><a href="#cb4-268" tabindex="-1"></a>                      kuso1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(kuso1)</span>
<span id="cb4-269"><a href="#cb4-269" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;weight:&#39;</span>,weight_temp,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-270"><a href="#cb4-270" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;拉姆慕达：&#39;</span>,lambdass,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-271"><a href="#cb4-271" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;gred_lambda:&#39;</span>,gred_lambda,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>,<span class="st">&#39;weight_kuso1:&#39;</span>,kuso1,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-272"><a href="#cb4-272" tabindex="-1"></a>                      beta_cal[<span class="fu">as.logical</span>(record)] <span class="ot">=</span> kuso1</span>
<span id="cb4-273"><a href="#cb4-273" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;mse_l2:&#39;</span>,<span class="fu">sum</span>((beta_cal<span class="sc">*</span>L<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-274"><a href="#cb4-274" tabindex="-1"></a>                      </span>
<span id="cb4-275"><a href="#cb4-275" tabindex="-1"></a>                    }</span>
<span id="cb4-276"><a href="#cb4-276" tabindex="-1"></a></span>
<span id="cb4-277"><a href="#cb4-277" tabindex="-1"></a>                    beta_cal<span class="ot">&lt;-</span><span class="fu">numeric</span>(p)</span>
<span id="cb4-278"><a href="#cb4-278" tabindex="-1"></a>                    <span class="cf">if</span>(size.A0<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> dimx <span class="sc">&gt;</span><span class="dv">16</span>){</span>
<span id="cb4-279"><a href="#cb4-279" tabindex="-1"></a>                      <span class="cf">if</span>(zz<span class="sc">==</span><span class="dv">1</span>) kiu <span class="ot">&lt;-</span> <span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.015</span>,<span class="fl">0.023</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.004</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0002</span>,<span class="fl">0.0003</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-280"><a href="#cb4-280" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">2</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.035</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.011</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0005</span>,<span class="fl">0.0009</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-281"><a href="#cb4-281" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">3</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.045</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.014</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0005</span>,<span class="fl">0.0014</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-282"><a href="#cb4-282" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">4</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.051</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.017</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0005</span>,<span class="fl">0.0017</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-283"><a href="#cb4-283" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">&gt;</span> <span class="dv">4</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0045</span>,<span class="fl">0.055</span>,<span class="fl">0.001</span>)<span class="sc">+</span>(zz<span class="dv">-4</span>)<span class="sc">*</span><span class="fl">0.00</span>),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.019</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0001</span>,<span class="fl">0.002</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-284"><a href="#cb4-284" tabindex="-1"></a>                      </span>
<span id="cb4-285"><a href="#cb4-285" tabindex="-1"></a>                    }</span>
<span id="cb4-286"><a href="#cb4-286" tabindex="-1"></a>                    <span class="cf">if</span>(size.A0<span class="sc">==</span><span class="dv">4</span><span class="sc">&amp;</span> dimx <span class="sc">&gt;</span><span class="dv">16</span>){</span>
<span id="cb4-287"><a href="#cb4-287" tabindex="-1"></a>                      <span class="cf">if</span>(zz<span class="sc">==</span><span class="dv">1</span>) kiu <span class="ot">&lt;-</span> <span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.015</span>,<span class="fl">0.022</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.004</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0001</span>,<span class="fl">0.0003</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-288"><a href="#cb4-288" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">2</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.025</span>,<span class="fl">0.035</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.003</span>,<span class="fl">0.008</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0005</span>,<span class="fl">0.0009</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-289"><a href="#cb4-289" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">3</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.031</span>,<span class="fl">0.045</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.005</span>,<span class="fl">0.012</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0009</span>,<span class="fl">0.0013</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-290"><a href="#cb4-290" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">4</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.035</span>,<span class="fl">0.051</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.015</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.0015</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-291"><a href="#cb4-291" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">&gt;</span> <span class="dv">4</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.045</span>,<span class="fl">0.055</span>,<span class="fl">0.001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.00</span>),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.015</span>,<span class="fl">0.019</span>,<span class="fl">0.001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.00</span>),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0015</span>,<span class="fl">0.002</span>,<span class="fl">0.0001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.000</span>)),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-292"><a href="#cb4-292" tabindex="-1"></a>                    }</span>
<span id="cb4-293"><a href="#cb4-293" tabindex="-1"></a>                    <span class="cf">if</span>(size.A0<span class="sc">==</span><span class="dv">8</span><span class="sc">&amp;</span> dimx <span class="sc">&gt;</span><span class="dv">16</span>){</span>
<span id="cb4-294"><a href="#cb4-294" tabindex="-1"></a>                      <span class="cf">if</span>(zz<span class="sc">==</span><span class="dv">1</span>) kiu <span class="ot">&lt;-</span> <span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="dv">3</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.00002</span>,<span class="fl">0.000025</span>,<span class="fl">0.000001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.003</span>,<span class="fl">0.006</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0005</span>,<span class="fl">0.0006</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-295"><a href="#cb4-295" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">2</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="dv">3</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.000035</span>,<span class="fl">0.00004</span>,<span class="fl">0.000001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.006</span>,<span class="fl">0.008</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0007</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-296"><a href="#cb4-296" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">3</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="dv">3</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.000031</span>,<span class="fl">0.000045</span>,<span class="fl">0.000001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.008</span>,<span class="fl">0.013</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0009</span>,<span class="fl">0.0013</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-297"><a href="#cb4-297" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">4</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="dv">3</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.000041</span>,<span class="fl">0.000052</span>,<span class="fl">0.000001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.012</span>,<span class="fl">0.016</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0014</span>,<span class="fl">0.0018</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-298"><a href="#cb4-298" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">&gt;</span> <span class="dv">4</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="dv">3</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.000045</span>,<span class="fl">0.000055</span>,<span class="fl">0.000001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.000001</span>),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.014</span>,<span class="fl">0.019</span>,<span class="fl">0.001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.001</span>),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0015</span>,<span class="fl">0.002</span>,<span class="fl">0.0001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.0001</span>)),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-299"><a href="#cb4-299" tabindex="-1"></a>                    }</span>
<span id="cb4-300"><a href="#cb4-300" tabindex="-1"></a>                    <span class="cf">if</span>(size.A0<span class="sc">==</span><span class="dv">12</span><span class="sc">&amp;</span> dimx <span class="sc">&gt;</span><span class="dv">16</span>){</span>
<span id="cb4-301"><a href="#cb4-301" tabindex="-1"></a>                      <span class="cf">if</span>(zz<span class="sc">==</span><span class="dv">1</span>) kiu <span class="ot">&lt;-</span> <span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.021</span>,<span class="fl">0.026</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.003</span>,<span class="fl">0.006</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.04</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0003</span>,<span class="fl">0.0005</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-302"><a href="#cb4-302" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">2</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.032</span>,<span class="fl">0.037</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.008</span>,<span class="fl">0.011</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.04</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0008</span>,<span class="fl">0.0012</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-303"><a href="#cb4-303" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">3</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.04</span>,<span class="fl">0.045</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.011</span>,<span class="fl">0.015</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.04</span>,<span class="fl">0.06</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0012</span>,<span class="fl">0.0015</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-304"><a href="#cb4-304" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">4</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.043</span>,<span class="fl">0.051</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.012</span>,<span class="fl">0.016</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.07</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0014</span>,<span class="fl">0.0018</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-305"><a href="#cb4-305" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">&gt;</span> <span class="dv">4</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.045</span>,<span class="fl">0.055</span>,<span class="fl">0.001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.001</span>),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.013</span>,<span class="fl">0.019</span>,<span class="fl">0.001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.001</span>),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0015</span>,<span class="fl">0.002</span>,<span class="fl">0.0001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.0001</span>)),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-306"><a href="#cb4-306" tabindex="-1"></a>                    }</span>
<span id="cb4-307"><a href="#cb4-307" tabindex="-1"></a>                    </span>
<span id="cb4-308"><a href="#cb4-308" tabindex="-1"></a>                    <span class="cf">if</span>(size.A0<span class="sc">&gt;</span><span class="dv">12</span><span class="sc">&amp;</span> dimx <span class="sc">&gt;</span><span class="dv">16</span>){</span>
<span id="cb4-309"><a href="#cb4-309" tabindex="-1"></a>                      <span class="cf">if</span>(zz<span class="sc">==</span><span class="dv">1</span>) kiu <span class="ot">&lt;-</span> <span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.021</span>,<span class="fl">0.027</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.003</span>,<span class="fl">0.006</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0003</span>,<span class="fl">0.0005</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-310"><a href="#cb4-310" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">2</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.035</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.007</span>,<span class="fl">0.010</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0008</span>,<span class="fl">0.0012</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-311"><a href="#cb4-311" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">3</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.035</span>,<span class="fl">0.041</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.012</span>,<span class="fl">0.016</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0012</span>,<span class="fl">0.0016</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-312"><a href="#cb4-312" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">==</span> <span class="dv">4</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.045</span>,<span class="fl">0.055</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.014</span>,<span class="fl">0.018</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0015</span>,<span class="fl">0.0019</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-313"><a href="#cb4-313" tabindex="-1"></a>                      <span class="cf">if</span>(zz <span class="sc">&gt;</span> <span class="dv">4</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.045</span>,<span class="fl">0.055</span>,<span class="fl">0.001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.001</span>),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.013</span>,<span class="fl">0.019</span>,<span class="fl">0.001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.001</span>),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0015</span>,<span class="fl">0.002</span>,<span class="fl">0.0001</span>)<span class="sc">+</span>(zz<span class="dv">-5</span>)<span class="sc">*</span><span class="fl">0.0001</span>)),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-314"><a href="#cb4-314" tabindex="-1"></a>                    }</span>
<span id="cb4-315"><a href="#cb4-315" tabindex="-1"></a>                    <span class="cf">if</span>(dimx <span class="sc">&lt;=</span><span class="dv">16</span>) kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.02</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.00001</span>,<span class="fl">0.0001</span>,<span class="fl">0.00001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-316"><a href="#cb4-316" tabindex="-1"></a>                    <span class="fu">cat</span>(<span class="st">&#39;kiu:&#39;</span>,kiu,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-317"><a href="#cb4-317" tabindex="-1"></a>                    <span class="cf">if</span>(<span class="fu">sum</span>(<span class="fu">which</span>(kiu<span class="sc">==</span><span class="dv">0</span>))<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb4-318"><a href="#cb4-318" tabindex="-1"></a>                      <span class="cf">if</span>(<span class="fu">sum</span>(<span class="fu">which</span>(kiu<span class="sc">==</span><span class="dv">0</span>))<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb4-319"><a href="#cb4-319" tabindex="-1"></a>                        <span class="cf">if</span>(dimx<span class="sc">&gt;</span><span class="dv">16</span>){</span>
<span id="cb4-320"><a href="#cb4-320" tabindex="-1"></a>                          kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.035</span>,<span class="fl">0.04</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.045</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.015</span>,<span class="fl">0.017</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.0016</span>,<span class="fl">0.0019</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-321"><a href="#cb4-321" tabindex="-1"></a>                          </span>
<span id="cb4-322"><a href="#cb4-322" tabindex="-1"></a>                          <span class="cf">if</span>(<span class="fu">sum</span>(<span class="fu">which</span>(kiu<span class="sc">==</span><span class="dv">0</span>))<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb4-323"><a href="#cb4-323" tabindex="-1"></a>                            kiu<span class="ot">&lt;-</span><span class="fu">debias_gic_select</span>(<span class="fu">rbind</span>(<span class="fu">expand.grid</span>(<span class="fl">0.5</span>,<span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.035</span>,<span class="fl">0.04</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">1</span>,<span class="fu">seq</span>(<span class="fl">0.045</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.015</span>,<span class="fl">0.017</span>,<span class="fl">0.001</span>)),<span class="fu">expand.grid</span>(<span class="dv">2</span>,<span class="fu">seq</span>(<span class="fl">0.03</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.002</span>,<span class="fl">0.0022</span>,<span class="fl">0.0001</span>))),n0,an,u0,<span class="fu">cov</span>(X[<span class="dv">1</span><span class="sc">:</span>n0,]),dimx,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),kuso1,<span class="fu">rep</span>(<span class="dv">1</span>,dimx),<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">0.21</span>,<span class="fl">2e2</span>,<span class="fl">1e-6</span>)</span>
<span id="cb4-324"><a href="#cb4-324" tabindex="-1"></a>                          }</span>
<span id="cb4-325"><a href="#cb4-325" tabindex="-1"></a>                        }</span>
<span id="cb4-326"><a href="#cb4-326" tabindex="-1"></a>                        <span class="cf">if</span>(<span class="fu">sum</span>(<span class="fu">which</span>(kiu<span class="sc">==</span><span class="dv">0</span>))<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb4-327"><a href="#cb4-327" tabindex="-1"></a>                          <span class="fu">stopCluster</span>(cl)</span>
<span id="cb4-328"><a href="#cb4-328" tabindex="-1"></a>                          kuso1<span class="ot">&lt;-</span>kiu</span>
<span id="cb4-329"><a href="#cb4-329" tabindex="-1"></a>                          <span class="cf">break</span></span>
<span id="cb4-330"><a href="#cb4-330" tabindex="-1"></a>                        }</span>
<span id="cb4-331"><a href="#cb4-331" tabindex="-1"></a>                      }</span>
<span id="cb4-332"><a href="#cb4-332" tabindex="-1"></a>                    }</span>
<span id="cb4-333"><a href="#cb4-333" tabindex="-1"></a>                    </span>
<span id="cb4-334"><a href="#cb4-334" tabindex="-1"></a>                    </span>
<span id="cb4-335"><a href="#cb4-335" tabindex="-1"></a>                    kuso1 <span class="ot">&lt;-</span> kiu</span>
<span id="cb4-336"><a href="#cb4-336" tabindex="-1"></a>                    kuso1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(kuso1)</span>
<span id="cb4-337"><a href="#cb4-337" tabindex="-1"></a>                    beta_cal<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,p)</span>
<span id="cb4-338"><a href="#cb4-338" tabindex="-1"></a>                    beta_cal[<span class="fu">as.logical</span>(record)] <span class="ot">=</span> kuso1</span>
<span id="cb4-339"><a href="#cb4-339" tabindex="-1"></a>                    beifenkuso<span class="ot">&lt;-</span> beta_cal</span>
<span id="cb4-340"><a href="#cb4-340" tabindex="-1"></a>                    <span class="fu">cat</span>(<span class="st">&#39;mse_l2:&#39;</span>,<span class="fu">sum</span>((beta_cal<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-341"><a href="#cb4-341" tabindex="-1"></a>            </span>
<span id="cb4-342"><a href="#cb4-342" tabindex="-1"></a>                    <span class="cf">if</span>(iter_times_num <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb4-343"><a href="#cb4-343" tabindex="-1"></a>                      fp_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_1,<span class="fu">fp</span>(beta_cal,beta0))</span>
<span id="cb4-344"><a href="#cb4-344" tabindex="-1"></a>                      fn_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_1,<span class="fu">fn</span>(beta_cal,beta0))</span>
<span id="cb4-345"><a href="#cb4-345" tabindex="-1"></a>                      p_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(p_1,dimx)</span>
<span id="cb4-346"><a href="#cb4-346" tabindex="-1"></a>                      mymse_l2_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(mymse_l2_1,<span class="fu">sum</span>((beta_cal<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-347"><a href="#cb4-347" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;fp_1:&#39;</span>,<span class="fu">fp</span>(beta_cal,beta0),<span class="st">&#39; &#39;</span>,<span class="st">&#39;fn_1:&#39;</span>,<span class="fu">fn</span>(beta_cal,beta0),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-348"><a href="#cb4-348" tabindex="-1"></a>                    }</span>
<span id="cb4-349"><a href="#cb4-349" tabindex="-1"></a>                    <span class="cf">if</span>(iter_times_num <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb4-350"><a href="#cb4-350" tabindex="-1"></a>                      fp_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_2,<span class="fu">fp</span>(beta_cal,beta0))</span>
<span id="cb4-351"><a href="#cb4-351" tabindex="-1"></a>                      fn_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_2,<span class="fu">fn</span>(beta_cal,beta0))</span>
<span id="cb4-352"><a href="#cb4-352" tabindex="-1"></a>                      p_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(p_2,dimx)</span>
<span id="cb4-353"><a href="#cb4-353" tabindex="-1"></a>                      mymse_l2_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(mymse_l2_2,<span class="fu">sum</span>((beta_cal<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-354"><a href="#cb4-354" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;fp_2:&#39;</span>,<span class="fu">fp</span>(beta_cal,beta0),<span class="st">&#39; &#39;</span>,<span class="st">&#39;fn_2:&#39;</span>,<span class="fu">fn</span>(beta_cal,beta0),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-355"><a href="#cb4-355" tabindex="-1"></a>                    }</span>
<span id="cb4-356"><a href="#cb4-356" tabindex="-1"></a>                    <span class="cf">if</span>(iter_times_num <span class="sc">==</span> <span class="dv">3</span>){</span>
<span id="cb4-357"><a href="#cb4-357" tabindex="-1"></a>                      fp_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_3,<span class="fu">fp</span>(beta_cal,beta0))</span>
<span id="cb4-358"><a href="#cb4-358" tabindex="-1"></a>                      fn_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_3,<span class="fu">fn</span>(beta_cal,beta0))</span>
<span id="cb4-359"><a href="#cb4-359" tabindex="-1"></a>                      p_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(p_3,dimx)</span>
<span id="cb4-360"><a href="#cb4-360" tabindex="-1"></a>                      mymse_l2_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(mymse_l2_3,<span class="fu">sum</span>((beta_cal<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-361"><a href="#cb4-361" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;fp_3:&#39;</span>,<span class="fu">fp</span>(beta_cal,beta0),<span class="st">&#39; &#39;</span>,<span class="st">&#39;fn_3:&#39;</span>,<span class="fu">fn</span>(beta_cal,beta0),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-362"><a href="#cb4-362" tabindex="-1"></a>                    }</span>
<span id="cb4-363"><a href="#cb4-363" tabindex="-1"></a>                    <span class="cf">if</span>(iter_times_num <span class="sc">==</span> <span class="dv">4</span>){</span>
<span id="cb4-364"><a href="#cb4-364" tabindex="-1"></a>                      fp_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_4,<span class="fu">fp</span>(beta_cal,beta0))</span>
<span id="cb4-365"><a href="#cb4-365" tabindex="-1"></a>                      fn_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_4,<span class="fu">fn</span>(beta_cal,beta0))</span>
<span id="cb4-366"><a href="#cb4-366" tabindex="-1"></a>                      p_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(p_4,dimx)</span>
<span id="cb4-367"><a href="#cb4-367" tabindex="-1"></a>                      mymse_l2_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(mymse_l2_4,<span class="fu">sum</span>((beta_cal<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-368"><a href="#cb4-368" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;fp_4:&#39;</span>,<span class="fu">fp</span>(beta_cal,beta0),<span class="st">&#39; &#39;</span>,<span class="st">&#39;fn_4:&#39;</span>,<span class="fu">fn</span>(beta_cal,beta0),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-369"><a href="#cb4-369" tabindex="-1"></a>                    }</span>
<span id="cb4-370"><a href="#cb4-370" tabindex="-1"></a>                    <span class="cf">if</span>(iter_times_num <span class="sc">==</span> <span class="dv">5</span>){</span>
<span id="cb4-371"><a href="#cb4-371" tabindex="-1"></a>                      fp_5 <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_5,<span class="fu">fp</span>(beta_cal,beta0))</span>
<span id="cb4-372"><a href="#cb4-372" tabindex="-1"></a>                      fn_5 <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_5,<span class="fu">fn</span>(beta_cal,beta0))</span>
<span id="cb4-373"><a href="#cb4-373" tabindex="-1"></a>                      p_5 <span class="ot">&lt;-</span> <span class="fu">c</span>(p_5,dimx)</span>
<span id="cb4-374"><a href="#cb4-374" tabindex="-1"></a>                      mymse_l2_5 <span class="ot">&lt;-</span> <span class="fu">c</span>(mymse_l2_5,<span class="fu">sum</span>((beta_cal<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-375"><a href="#cb4-375" tabindex="-1"></a>                      <span class="fu">cat</span>(<span class="st">&#39;fp_5:&#39;</span>,<span class="fu">fp</span>(beta_cal,beta0),<span class="st">&#39; &#39;</span>,<span class="st">&#39;fn_5:&#39;</span>,<span class="fu">fn</span>(beta_cal,beta0),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-376"><a href="#cb4-376" tabindex="-1"></a>                    }</span>
<span id="cb4-377"><a href="#cb4-377" tabindex="-1"></a>                    <span class="cf">if</span>(iter_times_num <span class="sc">==</span> <span class="dv">6</span>){</span>
<span id="cb4-378"><a href="#cb4-378" tabindex="-1"></a>                      fp_6 <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_6,<span class="fu">fp</span>(beta_cal,beta0))</span>
<span id="cb4-379"><a href="#cb4-379" tabindex="-1"></a>                      fn_6 <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_6,<span class="fu">fn</span>(beta_cal,beta0))</span>
<span id="cb4-380"><a href="#cb4-380" tabindex="-1"></a>                      p_6 <span class="ot">&lt;-</span> <span class="fu">c</span>(p_6,dimx)</span>
<span id="cb4-381"><a href="#cb4-381" tabindex="-1"></a>                      mymse_l2_6 <span class="ot">&lt;-</span> <span class="fu">c</span>(mymse_l2_6,<span class="fu">sum</span>((beta_cal<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-382"><a href="#cb4-382" tabindex="-1"></a>                    }</span>
<span id="cb4-383"><a href="#cb4-383" tabindex="-1"></a>                    iter_times_num <span class="ot">&lt;-</span> iter_times_num <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-384"><a href="#cb4-384" tabindex="-1"></a>                    <span class="co">#if (min(ttm[1:16]) &lt; 0.06 &amp;&amp; max(ttm[1:16]) &lt; 0.34) {</span></span>
<span id="cb4-385"><a href="#cb4-385" tabindex="-1"></a>                    <span class="co">#对整体乘以1.2</span></span>
<span id="cb4-386"><a href="#cb4-386" tabindex="-1"></a>                    <span class="co"># ttm &lt;- ttm * 1.2</span></span>
<span id="cb4-387"><a href="#cb4-387" tabindex="-1"></a>                    <span class="co">#}</span></span>
<span id="cb4-388"><a href="#cb4-388" tabindex="-1"></a>                    </span>
<span id="cb4-389"><a href="#cb4-389" tabindex="-1"></a>                  }</span>
<span id="cb4-390"><a href="#cb4-390" tabindex="-1"></a><span class="co">#&gt; sizea0: 0 </span></span>
<span id="cb4-391"><a href="#cb4-391" tabindex="-1"></a><span class="co">#&gt; iter: 1 </span></span>
<span id="cb4-392"><a href="#cb4-392" tabindex="-1"></a><span class="co">#&gt; sump: 85 </span></span>
<span id="cb4-393"><a href="#cb4-393" tabindex="-1"></a><span class="co">#&gt; dimx 2150 500 </span></span>
<span id="cb4-394"><a href="#cb4-394" tabindex="-1"></a><span class="co">#&gt; 500 </span></span>
<span id="cb4-395"><a href="#cb4-395" tabindex="-1"></a><span class="co">#&gt; lambda_score: 1 2 3 4 5 6 7 8 9 10 11 </span></span>
<span id="cb4-396"><a href="#cb4-396" tabindex="-1"></a><span class="co">#&gt; weight: 0.1089519 0.1013736 0.1894168 0.07574757 0.07488037 0.1211274 0.07293394 0.09392348 0.0791257 0.02987626 0.08893531 0.06755709 0.1132517 0.03871983 0.02981393 0.09778382 0.2100265 0.08907263 0.1277879 0.04277946 </span></span>
<span id="cb4-397"><a href="#cb4-397" tabindex="-1"></a><span class="co">#&gt; 拉姆慕达： 1.509955 1.610619 1.711282 1.811946 1.91261 2.013273 2.113937 2.214601 2.315264 2.415928 2.516592 </span></span>
<span id="cb4-398"><a href="#cb4-398" tabindex="-1"></a><span class="co">#&gt; gred_lambda: 1.509955 </span></span>
<span id="cb4-399"><a href="#cb4-399" tabindex="-1"></a><span class="co">#&gt;  weight_kuso1: -0.3928296 0.2010661 0.224533 0.2321974 0.1667308 0.2058527 0.2261592 0.1666758 0.1557874 0.2054297 0.22295 0.1350398 0.152289 0.1071919 0.1187894 0.1725131 0.01425201 0.02509799 0.005403224 0.08831303 0.02325629 0.03917238 0.1337706 0.006982571 0.07087129 0.0867755 -0.01890782 0.07375267 0.04868729 0.0676035 0.03135123 0.01894614 0.06399861 0.08730569 0.08739615 0.04332233 0.04027164 0.0346707 0.06198167 0.09123174 0.05383202 0.06633243 0.0238446 0.006974536 0.03833328 0.04153768 0.04289842 0.0242721 0.07221481 0.02251547 0.08118632 0.086392 0.1247342 0.05192021 0.07034549 0.0018393 0.06828186 0.03815489 -0.01107054 0.003221557 0.03304926 0.07645371 0.0694423 0.03002908 0.06535775 0.0547596 0.06936212 0.0773755 0.05213757 0.07165559 0.05946246 -0.007705886 0.111715 0.07798463 0.0498663 0.05780846 0.01988628 0.08848813 0.04921731 0.06097592 0.02131365 0.06905506 0.01925133 0.0440876 0.07713723 </span></span>
<span id="cb4-400"><a href="#cb4-400" tabindex="-1"></a><span class="co">#&gt; mse_l2: 1.093946 </span></span>
<span id="cb4-401"><a href="#cb4-401" tabindex="-1"></a><span class="co">#&gt; last_gamma: 2 last_lambda1: 0.02 last_lambda2: 3e-04 gic_max: 0.1607495 </span></span>
<span id="cb4-402"><a href="#cb4-402" tabindex="-1"></a><span class="co">#&gt; kiu: 0.1824008 0.470283 0.1942045 0.390253 0.2954481 0.3291585 0.2720968 0.2032644 0.2708697 0.2471567 0.3410098 0.1624691 0.207517 0.213352 0.2636878 0.3572734 0 0 0 0.04100873 0 0 0.03149005 0 0 0.07478576 0 0 0 0 0 0 0 0.1050393 0 0 0 0 0 -0.02212939 0 0 0 0 0 0 0 0 0 0 0 0.1039307 0.1500703 0 0 0 0 0 0 0 0 0.07651043 0 0 0 0 0 0 0 0.07788352 0 0 0.05502033 0 0 0 0 0.04500341 0 0 0 0.004122065 0 0 0 </span></span>
<span id="cb4-403"><a href="#cb4-403" tabindex="-1"></a><span class="co">#&gt; mse_l2: 0.1881699 </span></span>
<span id="cb4-404"><a href="#cb4-404" tabindex="-1"></a><span class="co">#&gt; fp_1: 0.02479339   fn_1: 0 </span></span>
<span id="cb4-405"><a href="#cb4-405" tabindex="-1"></a><span class="co">#&gt; sizea0: 0 </span></span>
<span id="cb4-406"><a href="#cb4-406" tabindex="-1"></a><span class="co">#&gt; iter: 2 </span></span>
<span id="cb4-407"><a href="#cb4-407" tabindex="-1"></a><span class="co">#&gt; sump: 28 </span></span>
<span id="cb4-408"><a href="#cb4-408" tabindex="-1"></a><span class="co">#&gt; dimx 2150 85 </span></span>
<span id="cb4-409"><a href="#cb4-409" tabindex="-1"></a><span class="co">#&gt; 85 </span></span>
<span id="cb4-410"><a href="#cb4-410" tabindex="-1"></a><span class="co">#&gt; weight: 0.1089519 0.1013736 0.1894168 0.07574757 0.07488037 0.1211274 0.07293394 0.09392348 0.0791257 0.02987626 0.08893531 0.06755709 0.1132517 0.03871983 0.02981393 0.09778382 0.2100265 0.08907263 0.1277879 0.04277946 </span></span>
<span id="cb4-411"><a href="#cb4-411" tabindex="-1"></a><span class="co">#&gt; kuso: -0.3482047 0.2244781 0.2804395 0.2544337 0.1990597 0.2077599 0.2335623 0.2534905 0.1842164 0.1925709 0.2355612 0.124154 0.1808096 0.1419086 0.1763045 0.2026805 0.09563952 0.1484544 0.1129476 0.09061083 0.06496427 0.1032153 0.1384524 0.1084484 0.0706624 0.1340433 0.1310346 0.09145562 </span></span>
<span id="cb4-412"><a href="#cb4-412" tabindex="-1"></a><span class="co">#&gt; mse_l2: 1.44 </span></span>
<span id="cb4-413"><a href="#cb4-413" tabindex="-1"></a><span class="co">#&gt; last_gamma: 1 last_lambda1: 0.03 last_lambda2: 0.011 gic_max: 0.236908 </span></span>
<span id="cb4-414"><a href="#cb4-414" tabindex="-1"></a><span class="co">#&gt; kiu: 0.225094 0.4817127 0.2933477 0.429904 0.2589926 0.3726389 0.2818077 0.3058524 0.2289762 0.232349 0.3722297 0.07892028 0.2181583 0.1712218 0.2502306 0.3385681 0 0 0.01731045 0 0 0 0.1293875 0.02441941 0 0 0 0 </span></span>
<span id="cb4-415"><a href="#cb4-415" tabindex="-1"></a><span class="co">#&gt; mse_l2: 0.1714709 </span></span>
<span id="cb4-416"><a href="#cb4-416" tabindex="-1"></a><span class="co">#&gt; fp_2: 0.006198347   fn_2: 0 </span></span>
<span id="cb4-417"><a href="#cb4-417" tabindex="-1"></a><span class="co">#&gt; sizea0: 0 </span></span>
<span id="cb4-418"><a href="#cb4-418" tabindex="-1"></a><span class="co">#&gt; iter: 3 </span></span>
<span id="cb4-419"><a href="#cb4-419" tabindex="-1"></a><span class="co">#&gt; sump: 19 </span></span>
<span id="cb4-420"><a href="#cb4-420" tabindex="-1"></a><span class="co">#&gt; dimx 2150 28 </span></span>
<span id="cb4-421"><a href="#cb4-421" tabindex="-1"></a><span class="co">#&gt; 28 </span></span>
<span id="cb4-422"><a href="#cb4-422" tabindex="-1"></a><span class="co">#&gt; weight: 0.1089519 0.1013736 0.1894168 0.07574757 0.07488037 0.1211274 0.07293394 0.09392348 0.0791257 0.02987626 0.08893531 0.06755709 0.1132517 0.03871983 0.02981393 0.09778382 0.2100265 0.08907263 0.1277879 0.04277946 </span></span>
<span id="cb4-423"><a href="#cb4-423" tabindex="-1"></a><span class="co">#&gt; kuso: -0.3773736 0.2338371 0.2530978 0.2990836 0.2078637 0.2183641 0.2105255 0.2556742 0.198502 0.2372468 0.2412268 0.1447833 0.2055677 0.1511832 0.1803577 0.2238976 0.1019092 0.1503904 0.1162113 </span></span>
<span id="cb4-424"><a href="#cb4-424" tabindex="-1"></a><span class="co">#&gt; mse_l2: 1.44 </span></span>
<span id="cb4-425"><a href="#cb4-425" tabindex="-1"></a><span class="co">#&gt; last_gamma: 2 last_lambda1: 0.02 last_lambda2: 0.0014 gic_max: 0.2615067 </span></span>
<span id="cb4-426"><a href="#cb4-426" tabindex="-1"></a><span class="co">#&gt; kiu: 0.2296621 0.4499428 0.2498386 0.4293102 0.2745209 0.3782571 0.2538067 0.2868077 0.2625354 0.2344305 0.3837529 0.05186703 0.2252063 0.2304456 0.2858094 0.346928 0 0.09227635 0 </span></span>
<span id="cb4-427"><a href="#cb4-427" tabindex="-1"></a><span class="co">#&gt; mse_l2: 0.1513867 </span></span>
<span id="cb4-428"><a href="#cb4-428" tabindex="-1"></a><span class="co">#&gt; fp_3: 0.002066116   fn_3: 0 </span></span>
<span id="cb4-429"><a href="#cb4-429" tabindex="-1"></a><span class="co">#&gt; sizea0: 0 </span></span>
<span id="cb4-430"><a href="#cb4-430" tabindex="-1"></a><span class="co">#&gt; iter: 4 </span></span>
<span id="cb4-431"><a href="#cb4-431" tabindex="-1"></a><span class="co">#&gt; sump: 17 </span></span>
<span id="cb4-432"><a href="#cb4-432" tabindex="-1"></a><span class="co">#&gt; dimx 2150 19 </span></span>
<span id="cb4-433"><a href="#cb4-433" tabindex="-1"></a><span class="co">#&gt; 19 </span></span>
<span id="cb4-434"><a href="#cb4-434" tabindex="-1"></a><span class="co">#&gt; weight: 0.1089519 0.1013736 0.1894168 0.07574757 0.07488037 0.1211274 0.07293394 0.09392348 0.0791257 0.02987626 0.08893531 0.06755709 0.1132517 0.03871983 0.02981393 0.09778382 0.2100265 0.08907263 0.1277879 0.04277946 </span></span>
<span id="cb4-435"><a href="#cb4-435" tabindex="-1"></a><span class="co">#&gt; kuso: -0.4149546 0.2334518 0.259241 0.3064553 0.2068034 0.2217739 0.2166284 0.2517387 0.2061027 0.2308639 0.2479184 0.1562973 0.1999967 0.1629387 0.1797825 0.1970201 0.1563632 </span></span>
<span id="cb4-436"><a href="#cb4-436" tabindex="-1"></a><span class="co">#&gt; mse_l2: 1.44 </span></span>
<span id="cb4-437"><a href="#cb4-437" tabindex="-1"></a><span class="co">#&gt; last_gamma: 1 last_lambda1: 0.03 last_lambda2: 0.009 gic_max: 0.2690866 </span></span>
<span id="cb4-438"><a href="#cb4-438" tabindex="-1"></a><span class="co">#&gt; kiu: 0.3561928 0.4161721 0.1804239 0.2749384 0.3176549 0.3795751 0.3165105 0.1465095 0.2341858 0.1191581 0.3585775 0 0.1653928 0.3421967 0.2853277 0.286213 0.08723456 </span></span>
<span id="cb4-439"><a href="#cb4-439" tabindex="-1"></a><span class="co">#&gt; mse_l2: 0.2204374 </span></span>
<span id="cb4-440"><a href="#cb4-440" tabindex="-1"></a><span class="co">#&gt; fp_4: 0.002066116   fn_4: 0.0625 </span></span>
<span id="cb4-441"><a href="#cb4-441" tabindex="-1"></a><span class="co">#&gt; sizea0: 0 </span></span>
<span id="cb4-442"><a href="#cb4-442" tabindex="-1"></a><span class="co">#&gt; iter: 5 </span></span>
<span id="cb4-443"><a href="#cb4-443" tabindex="-1"></a><span class="co">#&gt; sump: 16 </span></span>
<span id="cb4-444"><a href="#cb4-444" tabindex="-1"></a><span class="co">#&gt; dimx 2150 17 </span></span>
<span id="cb4-445"><a href="#cb4-445" tabindex="-1"></a><span class="co">#&gt; 17 </span></span>
<span id="cb4-446"><a href="#cb4-446" tabindex="-1"></a><span class="co">#&gt; weight: 0.1089519 0.1013736 0.1894168 0.07574757 0.07488037 0.1211274 0.07293394 0.09392348 0.0791257 0.02987626 0.08893531 0.06755709 0.1132517 0.03871983 0.02981393 0.09778382 0.2100265 0.08907263 0.1277879 0.04277946 </span></span>
<span id="cb4-447"><a href="#cb4-447" tabindex="-1"></a><span class="co">#&gt; kuso: -0.3663871 0.2355229 0.2627079 0.2929543 0.2145761 0.2210723 0.2264518 0.2698382 0.2022095 0.2295695 0.2546158 0.1971005 0.1699448 0.1849302 0.2062947 0.161796 </span></span>
<span id="cb4-448"><a href="#cb4-448" tabindex="-1"></a><span class="co">#&gt; mse_l2: 1.44 </span></span>
<span id="cb4-449"><a href="#cb4-449" tabindex="-1"></a><span class="co">#&gt; last_gamma: 2 last_lambda1: 0.02 last_lambda2: 1e-05 gic_max: 0.2731361 </span></span>
<span id="cb4-450"><a href="#cb4-450" tabindex="-1"></a><span class="co">#&gt; kiu: 0.2451362 0.3810958 0.2445999 0.3526155 0.2617414 0.3613165 0.2725273 0.2969411 0.2809603 0.2599483 0.3443043 0.2372039 0.3203852 0.3306901 0.3034227 0.1947161</span></span>
<span id="cb4-451"><a href="#cb4-451" tabindex="-1"></a>                  </span>
<span id="cb4-452"><a href="#cb4-452" tabindex="-1"></a></span>
<span id="cb4-453"><a href="#cb4-453" tabindex="-1"></a>                  beta_cal<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,p)</span>
<span id="cb4-454"><a href="#cb4-454" tabindex="-1"></a>                  beta_cal[<span class="fu">as.logical</span>(record)] <span class="ot">=</span> kuso1</span>
<span id="cb4-455"><a href="#cb4-455" tabindex="-1"></a>                  <span class="co">#beta_cal &lt;- beifenkuso#这句话用来直接调用备份保存的kuso，因为不可逆</span></span>
<span id="cb4-456"><a href="#cb4-456" tabindex="-1"></a>                  beta_cal <span class="ot">&lt;-</span> <span class="fu">betascale</span>(beta_cal,Sig.X)</span>
<span id="cb4-457"><a href="#cb4-457" tabindex="-1"></a>                  mymse_l2_last <span class="ot">&lt;-</span> <span class="fu">c</span>(mymse_l2_last,<span class="fu">sum</span>((beta_cal<span class="sc">*</span>L<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-458"><a href="#cb4-458" tabindex="-1"></a>                  p_last <span class="ot">&lt;-</span> <span class="fu">c</span>(p_last,dimx)</span>
<span id="cb4-459"><a href="#cb4-459" tabindex="-1"></a>                  fp_last <span class="ot">&lt;-</span> <span class="fu">c</span>(fp_last,<span class="fu">fp</span>(beta_cal,beta0))</span>
<span id="cb4-460"><a href="#cb4-460" tabindex="-1"></a>                  fn_last <span class="ot">&lt;-</span> <span class="fu">c</span>(fn_last,<span class="fu">fn</span>(beta_cal,beta0))</span>
<span id="cb4-461"><a href="#cb4-461" tabindex="-1"></a>                  iter_times <span class="ot">&lt;-</span> <span class="fu">c</span>(iter_times,iter_times_num)</span>
<span id="cb4-462"><a href="#cb4-462" tabindex="-1"></a></span>
<span id="cb4-463"><a href="#cb4-463" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;kuso1:&#39;</span>,kuso1,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-464"><a href="#cb4-464" tabindex="-1"></a><span class="co">#&gt; kuso1: 0.2451362 0.3810958 0.2445999 0.3526155 0.2617414 0.3613165 0.2725273 0.2969411 0.2809603 0.2599483 0.3443043 0.2372039 0.3203852 0.3306901 0.3034227 0.1947161</span></span>
<span id="cb4-465"><a href="#cb4-465" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;zhi:&#39;</span>,(<span class="fu">as.numeric</span>(beta_cal<span class="sc">%*%</span><span class="fu">t</span>(X1[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">%*%</span>y1[<span class="dv">1</span><span class="sc">:</span>n0])<span class="sc">/</span><span class="fu">as.numeric</span>(beta_cal<span class="sc">%*%</span><span class="fu">t</span>(X1[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">%*%</span>X1[<span class="dv">1</span><span class="sc">:</span>n0,]<span class="sc">%*%</span>beta_cal)),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-466"><a href="#cb4-466" tabindex="-1"></a><span class="co">#&gt; zhi: 1.281342</span></span>
<span id="cb4-467"><a href="#cb4-467" tabindex="-1"></a>                  beta_fit <span class="ot">&lt;-</span> beta_cal<span class="sc">*</span>(<span class="fu">as.numeric</span>(beta_cal<span class="sc">%*%</span><span class="fu">t</span>(X1[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">%*%</span>y1[<span class="dv">1</span><span class="sc">:</span>n0])<span class="sc">/</span><span class="fu">as.numeric</span>(beta_cal<span class="sc">%*%</span><span class="fu">t</span>(X1[<span class="dv">1</span><span class="sc">:</span>n0,])<span class="sc">%*%</span>X1[<span class="dv">1</span><span class="sc">:</span>n0,]<span class="sc">%*%</span>beta_cal))</span>
<span id="cb4-468"><a href="#cb4-468" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;beta_fit:&#39;</span>,beta_fit,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-469"><a href="#cb4-469" tabindex="-1"></a><span class="co">#&gt; beta_fit: 0.2641202 0.4106088 0.2635424 0.3799229 0.2820113 0.3892977 0.2936325 0.3199369 0.3027186 0.2800793 0.3709681 0 0.2555736 0.3451967 0.3562995 0.3269205 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2097954 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span id="cb4-470"><a href="#cb4-470" tabindex="-1"></a></span>
<span id="cb4-471"><a href="#cb4-471" tabindex="-1"></a>                  </span>
<span id="cb4-472"><a href="#cb4-472" tabindex="-1"></a></span>
<span id="cb4-473"><a href="#cb4-473" tabindex="-1"></a>                  sse_fit <span class="ot">&lt;-</span> <span class="fu">c</span>(sse_fit,<span class="fu">sum</span>((beta_fit <span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-474"><a href="#cb4-474" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;His methods:&#39;</span>,mse.vec,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-475"><a href="#cb4-475" tabindex="-1"></a><span class="co">#&gt; His methods: 1.124101 1.124101 1.120701 0.823419 0.8698759 0.5743772 NA NA</span></span>
<span id="cb4-476"><a href="#cb4-476" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;sse_last:&#39;</span>,<span class="fu">sum</span>((beta_cal<span class="sc">*</span>L<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-477"><a href="#cb4-477" tabindex="-1"></a><span class="co">#&gt; sse_last: 0.1598855</span></span>
<span id="cb4-478"><a href="#cb4-478" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;sse_fit:&#39;</span>,<span class="fu">sum</span>((beta_fit <span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-479"><a href="#cb4-479" tabindex="-1"></a><span class="co">#&gt; sse_fit: 0.1773398</span></span>
<span id="cb4-480"><a href="#cb4-480" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;fp_oracle&#39;</span>,<span class="fu">fp</span>(beta.kA,beta0),<span class="st">&#39; &#39;</span>)</span>
<span id="cb4-481"><a href="#cb4-481" tabindex="-1"></a><span class="co">#&gt; fp_oracle 0.06818182</span></span>
<span id="cb4-482"><a href="#cb4-482" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;fn_oracle&#39;</span>,<span class="fu">fn</span>(beta.kA,beta0),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-483"><a href="#cb4-483" tabindex="-1"></a><span class="co">#&gt; fn_oracle 0.3125</span></span>
<span id="cb4-484"><a href="#cb4-484" tabindex="-1"></a>                  </span>
<span id="cb4-485"><a href="#cb4-485" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;fp_trans&#39;</span>,<span class="fu">fp</span>(beta.prop,beta0),<span class="st">&#39; &#39;</span>)</span>
<span id="cb4-486"><a href="#cb4-486" tabindex="-1"></a><span class="co">#&gt; fp_trans 0.4194215</span></span>
<span id="cb4-487"><a href="#cb4-487" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;fn_trans&#39;</span>,<span class="fu">fn</span>(beta.prop,beta0),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-488"><a href="#cb4-488" tabindex="-1"></a><span class="co">#&gt; fn_trans 0</span></span>
<span id="cb4-489"><a href="#cb4-489" tabindex="-1"></a>                  </span>
<span id="cb4-490"><a href="#cb4-490" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;fp_last&#39;</span>,<span class="fu">fp</span>(beta_cal,beta0),<span class="st">&#39; &#39;</span>)</span>
<span id="cb4-491"><a href="#cb4-491" tabindex="-1"></a><span class="co">#&gt; fp_last 0.002066116</span></span>
<span id="cb4-492"><a href="#cb4-492" tabindex="-1"></a>                  <span class="fu">cat</span>(<span class="st">&#39;fn_last&#39;</span>,<span class="fu">fn</span>(beta_cal,beta0),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-493"><a href="#cb4-493" tabindex="-1"></a><span class="co">#&gt; fn_last 0.0625</span></span>
<span id="cb4-494"><a href="#cb4-494" tabindex="-1"></a>                  </span>
<span id="cb4-495"><a href="#cb4-495" tabindex="-1"></a>                  <span class="cf">if</span>(<span class="fu">fp</span>(beta_cal,beta0)<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">fn</span>(beta_cal,beta0)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb4-496"><a href="#cb4-496" tabindex="-1"></a>                    cm_my <span class="ot">&lt;-</span> <span class="fu">c</span>(cm_my,<span class="dv">1</span>)</span>
<span id="cb4-497"><a href="#cb4-497" tabindex="-1"></a>                  }<span class="cf">else</span>{</span>
<span id="cb4-498"><a href="#cb4-498" tabindex="-1"></a>                    cm_my <span class="ot">&lt;-</span> <span class="fu">c</span>(cm_my,<span class="dv">0</span>)</span>
<span id="cb4-499"><a href="#cb4-499" tabindex="-1"></a>                  }</span>
<span id="cb4-500"><a href="#cb4-500" tabindex="-1"></a>                  </span>
<span id="cb4-501"><a href="#cb4-501" tabindex="-1"></a>                  <span class="cf">if</span>(<span class="fu">fp</span>(beta.kA,beta0)<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">fn</span>(beta.kA,beta0)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb4-502"><a href="#cb4-502" tabindex="-1"></a>                    cm_oracle <span class="ot">&lt;-</span> <span class="fu">c</span>(cm_oracle,<span class="dv">1</span>)</span>
<span id="cb4-503"><a href="#cb4-503" tabindex="-1"></a>                  }<span class="cf">else</span>{</span>
<span id="cb4-504"><a href="#cb4-504" tabindex="-1"></a>                    cm_oracle <span class="ot">&lt;-</span> <span class="fu">c</span>(cm_oracle,<span class="dv">0</span>)</span>
<span id="cb4-505"><a href="#cb4-505" tabindex="-1"></a>                  }</span>
<span id="cb4-506"><a href="#cb4-506" tabindex="-1"></a>                  </span>
<span id="cb4-507"><a href="#cb4-507" tabindex="-1"></a>                  <span class="cf">if</span>(<span class="fu">fp</span>(beta.prop,beta0)<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">fn</span>(beta.prop,beta0)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb4-508"><a href="#cb4-508" tabindex="-1"></a>                    cm_trans <span class="ot">&lt;-</span> <span class="fu">c</span>(cm_trans,<span class="dv">1</span>)</span>
<span id="cb4-509"><a href="#cb4-509" tabindex="-1"></a>                  }<span class="cf">else</span>{</span>
<span id="cb4-510"><a href="#cb4-510" tabindex="-1"></a>                    cm_trans <span class="ot">&lt;-</span> <span class="fu">c</span>(cm_trans,<span class="dv">0</span>)</span>
<span id="cb4-511"><a href="#cb4-511" tabindex="-1"></a>                  }</span>
<span id="cb4-512"><a href="#cb4-512" tabindex="-1"></a>    </span>
<span id="cb4-513"><a href="#cb4-513" tabindex="-1"></a>                  mse1 <span class="ot">&lt;-</span> <span class="fu">c</span>(mse1,mse.vec[<span class="dv">1</span>])</span>
<span id="cb4-514"><a href="#cb4-514" tabindex="-1"></a>                  mse2 <span class="ot">&lt;-</span> <span class="fu">c</span>(mse2,mse.vec[<span class="dv">2</span>])</span>
<span id="cb4-515"><a href="#cb4-515" tabindex="-1"></a>                  mse3 <span class="ot">&lt;-</span> <span class="fu">c</span>(mse3,mse.vec[<span class="dv">3</span>])</span>
<span id="cb4-516"><a href="#cb4-516" tabindex="-1"></a>                  mse4 <span class="ot">&lt;-</span> <span class="fu">c</span>(mse4,mse.vec[<span class="dv">4</span>])</span>
<span id="cb4-517"><a href="#cb4-517" tabindex="-1"></a>                  mse5 <span class="ot">&lt;-</span> <span class="fu">c</span>(mse5,mse.vec[<span class="dv">5</span>])</span>
<span id="cb4-518"><a href="#cb4-518" tabindex="-1"></a>                  mse6 <span class="ot">&lt;-</span> <span class="fu">c</span>(mse6,mse.vec[<span class="dv">6</span>])</span>
<span id="cb4-519"><a href="#cb4-519" tabindex="-1"></a></span>
<span id="cb4-520"><a href="#cb4-520" tabindex="-1"></a>                  </span>
<span id="cb4-521"><a href="#cb4-521" tabindex="-1"></a>                  </span>
<span id="cb4-522"><a href="#cb4-522" tabindex="-1"></a>                  </span>
<span id="cb4-523"><a href="#cb4-523" tabindex="-1"></a>                  ps <span class="ot">&lt;-</span> <span class="fu">c</span>(ps,p)</span>
<span id="cb4-524"><a href="#cb4-524" tabindex="-1"></a>                  n0s <span class="ot">&lt;-</span> <span class="fu">c</span>(n0s,n0)</span>
<span id="cb4-525"><a href="#cb4-525" tabindex="-1"></a>                  sizea0s <span class="ot">&lt;-</span> <span class="fu">c</span>(sizea0s,size.A0)</span>
<span id="cb4-526"><a href="#cb4-526" tabindex="-1"></a>                  sigbetas <span class="ot">&lt;-</span> <span class="fu">c</span>(sigbetas,sig.beta)</span>
<span id="cb4-527"><a href="#cb4-527" tabindex="-1"></a>                  Ms <span class="ot">&lt;-</span> <span class="fu">c</span>(Ms,M)</span>
<span id="cb4-528"><a href="#cb4-528" tabindex="-1"></a>                  hs <span class="ot">&lt;-</span> <span class="fu">c</span>(hs,h)</span>
<span id="cb4-529"><a href="#cb4-529" tabindex="-1"></a>                  exacts <span class="ot">&lt;-</span> <span class="fu">c</span>(exacts,exact)</span>
<span id="cb4-530"><a href="#cb4-530" tabindex="-1"></a>                  ss <span class="ot">&lt;-</span> <span class="fu">c</span>(ss,s)</span>
<span id="cb4-531"><a href="#cb4-531" tabindex="-1"></a>                  </span>
<span id="cb4-532"><a href="#cb4-532" tabindex="-1"></a>                  </span>
<span id="cb4-533"><a href="#cb4-533" tabindex="-1"></a>                  </span>
<span id="cb4-534"><a href="#cb4-534" tabindex="-1"></a>                  <span class="co">#print(betahat)</span></span>
<span id="cb4-535"><a href="#cb4-535" tabindex="-1"></a>                  </span>
<span id="cb4-536"><a href="#cb4-536" tabindex="-1"></a>                  end <span class="ot">&lt;-</span> (<span class="fu">proc.time</span>())[<span class="dv">3</span>][[<span class="dv">1</span>]]</span>
<span id="cb4-537"><a href="#cb4-537" tabindex="-1"></a>                  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;time = &#39;</span>, (end<span class="sc">-</span>start), <span class="st">&#39;s&#39;</span>, <span class="at">sep=</span><span class="st">&#39;&#39;</span>))</span>
<span id="cb4-538"><a href="#cb4-538" tabindex="-1"></a><span class="co">#&gt; [1] &quot;time = 177.87s&quot;</span></span></code></pre></div>
</div>
<div id="data-saving" class="section level2">
<h2>Data saving</h2>
<p>Save the data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    <span class="at">ps =</span> ps,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="at">n0s =</span> n0s,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="at">sizea0s =</span> sizea0s,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="at">sigbetas =</span> sigbetas,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="at">Ms =</span> Ms,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    <span class="at">hs =</span> hs,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    <span class="at">exacts =</span> exacts,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    <span class="at">ss =</span> ss,</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    <span class="at">mse1 =</span> mse1,</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>    <span class="at">mse2 =</span> mse2,</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>    <span class="at">mse3 =</span> mse3,</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>    <span class="at">mse4 =</span> mse4,</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>    <span class="at">mse5 =</span> mse5,</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>    <span class="at">mse6 =</span> mse6,</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>    trans_sse,</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>    mse_single_trans2,</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>    mse_single_trans1,</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>    fp_lasso,</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>    fn_lasso,</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>    fp_oracle,</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>    fn_oracle,</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>    fp_trans,</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>    fn_trans,</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>    fp_trans1,</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>    fn_trans1,</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>    fp_trans2,</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>    fn_trans2,</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>    fp_target,</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>    fn_target,</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>    cm_my,</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>    cm_oracle,</span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a>    cm_trans,</span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>    iter_times,</span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a>    p_ini,p_last,</span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a>    fp_ini,fp_last,</span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a>    fn_ini,fn_last,</span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a>    sse_target_only,</span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a>    mymse_l2_ini,mymse_l2_last,sse_fit</span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a>    </span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a>  )</span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a>  data_name <span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">&#39;newtranslearningsim_1027_ID&#39;</span>,<span class="fu">as.character</span>(sims),<span class="st">&#39;_seed&#39;</span>,<span class="fu">as.character</span>(<span class="dv">20231027</span><span class="sc">+</span>sims),<span class="st">&#39;.csv&#39;</span>,<span class="at">sep=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a>  <span class="fu">write.csv</span>(df, <span class="at">file =</span> data_name)</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
